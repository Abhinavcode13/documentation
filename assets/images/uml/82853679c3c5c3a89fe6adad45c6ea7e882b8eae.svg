<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="9348px" preserveAspectRatio="none" style="width:1666px;height:9348px;" version="1.1" viewBox="0 0 1666 9348" width="1666px" zoomAndPan="magnify"><defs><filter height="300%" id="f1astixi91bswf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="698" x="485" y="22.9951">2.2.2. Fulfil Handler Consume (Reject/Abort) (single message, includes individual transfers from Bulk)</text><rect fill="#FFFFE0" height="9303.2422" style="stroke: #A80036; stroke-width: 1.0;" width="1503" x="29" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="731.5" y="46.3638">Central Service</text><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="57.5" y="195.125"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="9136.5156" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="327.5" y="125.7266"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="813.5" y="6794.5625"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="813.5" y="7255.6875"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="813.5" y="8749.1172"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="813.5" y="9210.2422"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1018" y="2145.1484"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1018" y="2758.875"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1018" y="3444.7344"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1018" y="5824.8516"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1018" y="7779.4063"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1136.5" y="1653.7578"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1136.5" y="6285.9766"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1136.5" y="8240.5313"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="165.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="692.3828"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="165.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="983.9766"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="121.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="3554.8047"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="120.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="3758.6016"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="136.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="4028.9297"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="121.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="4312.9297"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="4722.3828" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="4540.8594"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="4319.1797" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1244" y="4944.0625"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="92.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="736.6484"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="92.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="1028.2422"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="3583.9375"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="62.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="3787.7344"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="4058.0625"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="4342.0625"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="4569.9922"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="4973.1953"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="5213.4063" style="stroke: #000000; stroke-width: 2.0;" width="1642" x="13" y="132.7266"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="5182.2734" style="stroke: #000000; stroke-width: 2.0;" width="1622" x="23" y="156.8594"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="105.5313" style="stroke: #000000; stroke-width: 2.0;" width="561.5" x="267" y="240.125"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="541.5" x="277" y="264.2578"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="106.6641" style="stroke: #000000; stroke-width: 2.0;" width="684.5" x="277" y="359.6563"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="102.5313" style="stroke: #000000; stroke-width: 2.0;" width="921.5" x="277" y="480.3203"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="3094.3516" style="stroke: #000000; stroke-width: 2.0;" width="1398" x="237" y="596.8516"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="2753.625" style="stroke: #000000; stroke-width: 2.0;" width="1355" x="247" y="930.5781"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="2331.8281" style="stroke: #000000; stroke-width: 2.0;" width="961.5" x="257" y="1164.9063"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="1001.1094" style="stroke: #000000; stroke-width: 2.0;" width="941.5" x="267" y="1189.0391"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="969.9766" style="stroke: #000000; stroke-width: 2.0;" width="921.5" x="277" y="1213.1719"/><rect fill="#FFFFFF" height="491.3906" style="stroke: none; stroke-width: 1.0;" width="921.5" x="277" y="1691.7578"/><rect fill="#FFFFFF" height="613.7266" style="stroke: none; stroke-width: 1.0;" width="961.5" x="257" y="2197.1484"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="584.9219" style="stroke: #000000; stroke-width: 2.0;" width="941.5" x="267" y="2218.9531"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="553.7891" style="stroke: #000000; stroke-width: 2.0;" width="921.5" x="277" y="2243.0859"/><rect fill="#FFFFFF" height="476.2578" style="stroke: none; stroke-width: 1.0;" width="921.5" x="277" y="2320.6172"/><rect fill="#FFFFFF" height="103.2031" style="stroke: none; stroke-width: 1.0;" width="961.5" x="257" y="2810.875"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="298.5" x="277" y="2832.6797"/><rect fill="#FFFFFF" height="582.6563" style="stroke: none; stroke-width: 1.0;" width="961.5" x="257" y="2914.0781"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="566.6563" style="stroke: #000000; stroke-width: 2.0;" width="837.5" x="267" y="2923.0781"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="535.5234" style="stroke: #000000; stroke-width: 2.0;" width="817.5" x="277" y="2947.2109"/><rect fill="#FFFFFF" height="476.2578" style="stroke: none; stroke-width: 1.0;" width="817.5" x="277" y="3006.4766"/><rect fill="#FFFFFF" height="180.4688" style="stroke: none; stroke-width: 1.0;" width="1355" x="247" y="3503.7344"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="1572.9922" style="stroke: #000000; stroke-width: 2.0;" width="1329" x="257" y="3705.2031"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="555.1953" style="stroke: #000000; stroke-width: 2.0;" width="1301" x="267" y="3894.1328"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="197.9297" style="stroke: #000000; stroke-width: 2.0;" width="1281" x="277" y="3975.5313"/><rect fill="#FFFFFF" height="268.8672" style="stroke: none; stroke-width: 1.0;" width="1301" x="267" y="4180.4609"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="182.7969" style="stroke: #000000; stroke-width: 2.0;" width="1281" x="277" y="4259.5313"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="374.3984" style="stroke: #000000; stroke-width: 2.0;" width="1309" x="267" y="4463.3281"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="182.7969" style="stroke: #000000; stroke-width: 2.0;" width="1289" x="277" y="4487.4609"/><rect fill="#FFFFFF" height="103.2031" style="stroke: none; stroke-width: 1.0;" width="1309" x="267" y="4734.5234"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="298.5" x="277" y="4756.3281"/><rect fill="#FFFFFF" height="433.4688" style="stroke: none; stroke-width: 1.0;" width="1329" x="257" y="4844.7266"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="404.6641" style="stroke: #000000; stroke-width: 2.0;" width="1309" x="267" y="4866.5313"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="213.0625" style="stroke: #000000; stroke-width: 2.0;" width="1289" x="277" y="4890.6641"/><rect fill="#FFFFFF" height="103.2031" style="stroke: none; stroke-width: 1.0;" width="1309" x="267" y="5167.9922"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="467.5" x="277" y="5189.7969"/><rect fill="#FFFFFF" height="53.9375" style="stroke: none; stroke-width: 1.0;" width="1622" x="23" y="5285.1953"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="970.8438" style="stroke: #000000; stroke-width: 2.0;" width="941.5" x="267" y="5360.1328"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="939.7109" style="stroke: #000000; stroke-width: 2.0;" width="921.5" x="277" y="5384.2656"/><rect fill="#FFFFFF" height="461.125" style="stroke: none; stroke-width: 1.0;" width="921.5" x="277" y="5862.8516"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="955.7109" style="stroke: #000000; stroke-width: 2.0;" width="635.5" x="267" y="6344.9766"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="924.5781" style="stroke: #000000; stroke-width: 2.0;" width="615.5" x="277" y="6369.1094"/><rect fill="#FFFFFF" height="461.125" style="stroke: none; stroke-width: 1.0;" width="615.5" x="277" y="6832.5625"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="970.8438" style="stroke: #000000; stroke-width: 2.0;" width="941.5" x="267" y="7314.6875"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="939.7109" style="stroke: #000000; stroke-width: 2.0;" width="921.5" x="277" y="7338.8203"/><rect fill="#FFFFFF" height="461.125" style="stroke: none; stroke-width: 1.0;" width="921.5" x="277" y="7817.4063"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="955.7109" style="stroke: #000000; stroke-width: 2.0;" width="635.5" x="267" y="8299.5313"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="924.5781" style="stroke: #000000; stroke-width: 2.0;" width="615.5" x="277" y="8323.6641"/><rect fill="#FFFFFF" height="461.125" style="stroke: none; stroke-width: 1.0;" width="615.5" x="277" y="8787.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="62" x2="62" y1="115.7266" y2="9272.2422"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="332" x2="332" y1="115.7266" y2="9272.2422"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="818.5" x2="818.5" y1="115.7266" y2="9272.2422"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="921.5" x2="921.5" y1="115.7266" y2="9272.2422"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1022.5" x2="1022.5" y1="115.7266" y2="9272.2422"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1141.5" x2="1141.5" y1="115.7266" y2="9272.2422"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1243.5" x2="1243.5" y1="115.7266" y2="9272.2422"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1484" x2="1484" y1="115.7266" y2="9272.2422"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="37" y="60.1328"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="33" y="64.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="40" y="84.1279">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="44.5" y="100.4248">fulfil</text><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="37" y="9271.2422"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="33" y="9275.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="40" y="9295.2373">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="44.5" y="9311.5342">fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="287" y="112.4248">Fulfil Handler</text><ellipse cx="332.5" cy="83.4297" fill="#FEFECE" filter="url(#f1astixi91bswf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="328.5,71.4297,334.5,66.4297,332.5,71.4297,334.5,76.4297,328.5,71.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="287" y="9284.2373">Fulfil Handler</text><ellipse cx="332.5" cy="9303.5391" fill="#FEFECE" filter="url(#f1astixi91bswf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="328.5,9291.5391,334.5,9286.5391,332.5,9291.5391,334.5,9296.5391,328.5,9291.5391" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="120" x="758.5" y="60.1328"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="120" x="754.5" y="64.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="796" y="84.1279">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="761.5" y="100.4248">transfer-position</text><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="120" x="758.5" y="9271.2422"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="120" x="754.5" y="9275.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="796" y="9295.2373">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="761.5" y="9311.5342">transfer-position</text><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="896.5" y="60.1328"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="892.5" y="64.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="899.5" y="84.1279">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="900" y="100.4248">event</text><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="896.5" y="9271.2422"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="892.5" y="9275.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="899.5" y="9295.2373">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="900" y="9311.5342">event</text><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="965.5" y="60.1328"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="961.5" y="64.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1000.5" y="84.1279">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="968.5" y="100.4248">bulk-processing</text><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="965.5" y="9271.2422"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="961.5" y="9275.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1000.5" y="9295.2373">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="968.5" y="9311.5342">bulk-processing</text><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="1098.5" y="60.1328"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="1094.5" y="64.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1119" y="84.1279">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="1101.5" y="100.4248">notification</text><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="1098.5" y="9271.2422"/><rect fill="#FEFECE" filter="url(#f1astixi91bswf)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="1094.5" y="9275.2422"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1119" y="9295.2373">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="1101.5" y="9311.5342">notification</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1198.5" y="112.4248">Transfer DAO</text><ellipse cx="1244" cy="83.4297" fill="#FEFECE" filter="url(#f1astixi91bswf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1232" x2="1256" y1="97.4297" y2="97.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1198.5" y="9284.2373">Transfer DAO</text><ellipse cx="1244" cy="9303.5391" fill="#FEFECE" filter="url(#f1astixi91bswf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1232" x2="1256" y1="9317.5391" y2="9317.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1440" y="112.4248">Central Store</text><path d="M1466,63.4297 C1466,53.4297 1484,53.4297 1484,53.4297 C1484,53.4297 1502,53.4297 1502,63.4297 L1502,89.4297 C1502,99.4297 1484,99.4297 1484,99.4297 C1484,99.4297 1466,99.4297 1466,89.4297 L1466,63.4297 " fill="#FEFECE" filter="url(#f1astixi91bswf)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1466,63.4297 C1466,73.4297 1484,73.4297 1484,73.4297 C1484,73.4297 1502,73.4297 1502,63.4297 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1440" y="9284.2373">Central Store</text><path d="M1466,9297.5391 C1466,9287.5391 1484,9287.5391 1484,9287.5391 C1484,9287.5391 1502,9287.5391 1502,9297.5391 L1502,9323.5391 C1502,9333.5391 1484,9333.5391 1484,9333.5391 C1484,9333.5391 1466,9333.5391 1466,9323.5391 L1466,9297.5391 " fill="#FEFECE" filter="url(#f1astixi91bswf)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1466,9297.5391 C1466,9307.5391 1484,9307.5391 1484,9307.5391 C1484,9307.5391 1502,9307.5391 1502,9297.5391 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="57.5" y="195.125"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="9136.5156" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="327.5" y="125.7266"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="813.5" y="6794.5625"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="813.5" y="7255.6875"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="813.5" y="8749.1172"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="813.5" y="9210.2422"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1018" y="2145.1484"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1018" y="2758.875"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1018" y="3444.7344"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1018" y="5824.8516"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1018" y="7779.4063"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1136.5" y="1653.7578"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1136.5" y="6285.9766"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1136.5" y="8240.5313"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="165.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="692.3828"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="165.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="983.9766"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="121.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="3554.8047"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="120.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="3758.6016"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="136.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="4028.9297"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="121.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="4312.9297"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="4722.3828" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1239" y="4540.8594"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="4319.1797" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1244" y="4944.0625"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="92.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="736.6484"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="92.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="1028.2422"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="3583.9375"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="62.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="3787.7344"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="4058.0625"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="4342.0625"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="4569.9922"/><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1479" y="4973.1953"/><path d="M13,132.7266 L261,132.7266 L261,139.7266 L251,149.7266 L13,149.7266 L13,132.7266 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="5213.4063" style="stroke: #000000; stroke-width: 2.0;" width="1642" x="13" y="132.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="203" x="28" y="145.7935">Fulfil Handler Consume (Failure)</text><path d="M23,156.8594 L86,156.8594 L86,163.8594 L76,173.8594 L23,173.8594 L23,156.8594 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="5182.2734" style="stroke: #000000; stroke-width: 2.0;" width="1622" x="23" y="156.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="38" y="169.9263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="101" y="169.0698">[Consume Single Message]</text><polygon fill="#A80036" points="78.5,191.125,68.5,195.125,78.5,199.125,74.5,195.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="326.5" y1="195.125" y2="195.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="84.5" y="190.0591">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="95.5" y="190.0591">Consume Fulfil event message for Payer</text><path d="M267,240.125 L350,240.125 L350,247.125 L340,257.125 L267,257.125 L267,240.125 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="105.5313" style="stroke: #000000; stroke-width: 2.0;" width="561.5" x="267" y="240.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="282" y="253.1919">break</text><path d="M277,264.2578 L415,264.2578 L415,271.2578 L405,281.2578 L277,281.2578 L277,264.2578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="541.5" x="277" y="264.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="292" y="277.3247">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="317.6563" y2="317.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="317.6563" y2="330.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="330.6563" y2="330.6563"/><polygon fill="#A80036" points="348.5,326.6563,338.5,330.6563,348.5,334.6563,344.5,330.6563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="344.5" y="305.0239">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="451" x="355.5" y="297.4575">Validate event - Rule: type IN ['fulfil','bulk-fulfil'] &amp;&amp; ( action IN ['reject','abort'] )</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="355.5" y="312.5903">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="435.5" y="312.5903">2001</text><path d="M277,359.6563 L487,359.6563 L487,366.6563 L477,376.6563 L277,376.6563 L277,359.6563 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="106.6641" style="stroke: #000000; stroke-width: 2.0;" width="684.5" x="277" y="359.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="292" y="372.7231">Persist Event Information</text><polygon fill="#A80036" points="910,393.9219,920,397.9219,910,401.9219,914,397.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="916" y1="397.9219" y2="397.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="344.5" y="392.856">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="355.5" y="392.856">Publish event information</text><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="666.5" x="284" y="405.9219"/><polygon fill="#EEEEEE" points="284,405.9219,348,405.9219,348,412.9219,338,422.9219,284,422.9219,284,405.9219" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="297" y="419.9888">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="548.75" y="438.9888">Event Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="551.75" y="454.1216"/><path d="M277,480.3203 L491,480.3203 L491,487.3203 L481,497.3203 L277,497.3203 L277,480.3203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="102.5313" style="stroke: #000000; stroke-width: 2.0;" width="921.5" x="277" y="480.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="169" x="292" y="493.3872">Validate FSPIOP-Signature</text><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="903.5" x="284" y="522.4531"/><polygon fill="#EEEEEE" points="284,522.4531,348,522.4531,348,529.4531,338,539.4531,284,539.4531,284,522.4531" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="297" y="536.52">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="580.75" y="555.52">Validate message.content.headers.</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="782.75" y="555.52">FSPIOP-Signature</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="580.75" y="570.6528">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="660.75" y="570.6528">2001</text><path d="M237,596.8516 L534,596.8516 L534,603.8516 L524,613.8516 L237,613.8516 L237,596.8516 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="3094.3516" style="stroke: #000000; stroke-width: 2.0;" width="1398" x="237" y="596.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="252" x="252" y="609.9185">Validate Transfer Fulfil Duplicate Check</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="635.1172" y2="635.1172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="635.1172" y2="648.1172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="648.1172" y2="648.1172"/><polygon fill="#A80036" points="348.5,644.1172,338.5,648.1172,348.5,652.1172,344.5,648.1172" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="344.5" y="630.0513">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="355.5" y="630.0513">Generate transferFulfilmentId uuid</text><polygon fill="#A80036" points="1227,688.3828,1237,692.3828,1227,696.3828,1231,692.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1233" y1="692.3828" y2="692.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="344.5" y="679.7505">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="341" x="355.5" y="672.1841">Request to retrieve transfer fulfilment hashes by transferId</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="355.5" y="687.3169">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="429.5" y="687.3169">2003</text><polygon fill="#A80036" points="1467,732.6484,1477,736.6484,1467,740.6484,1471,736.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1249" x2="1473" y1="736.6484" y2="736.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="1256" y="724.0161">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1267" y="716.4497">Request Transfer fulfilment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="1267" y="731.5825">duplicate message hashes</text><polygon fill="#FFFFE0" filter="url(#f1astixi91bswf)" points="1353,749.6484,1615,749.6484,1625,775.6484,1615,802.6484,1353,802.6484,1343,775.6484,1353,749.6484" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="1355" y="765.7153">SELET transferId, hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="1355" y="780.8481">FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="220" x="1393" y="780.8481">transferFulfilmentDuplicateCheck</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="1355" y="795.981">WHERE transferId = request.params.id</text><polygon fill="#A80036" points="1260,825.1797,1250,829.1797,1260,833.1797,1256,829.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1254" x2="1483" y1="829.1797" y2="829.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="1266" y="824.1138">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="1277" y="824.1138">Return existing hashes</text><polygon fill="#A80036" points="348.5,854.3125,338.5,858.3125,348.5,862.3125,344.5,858.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="1243" y1="858.3125" y2="858.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="354.5" y="853.2466">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="365.5" y="853.2466">Return (list of) transfer fulfil messages hash(es)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="902.5781" y2="902.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="902.5781" y2="915.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="915.5781" y2="915.5781"/><polygon fill="#A80036" points="348.5,911.5781,338.5,915.5781,348.5,919.5781,344.5,915.5781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="344.5" y="889.9458">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="253" x="355.5" y="882.3794">Loop the list of returned hashes &amp; compare</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="355.5" y="897.5122">each entry with the calculated message hash</text><path d="M247,930.5781 L310,930.5781 L310,937.5781 L300,947.5781 L247,947.5781 L247,930.5781 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="2753.625" style="stroke: #000000; stroke-width: 2.0;" width="1355" x="247" y="930.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="262" y="943.645">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="84" x="325" y="942.7886">[Hash matched]</text><polygon fill="#A80036" points="1227,979.9766,1237,983.9766,1227,987.9766,1231,983.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1233" y1="983.9766" y2="983.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="971.3442">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="317" x="362.5" y="963.7778">Request to retrieve Transfer Fulfilment &amp; Transfer state</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="362.5" y="978.9106">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="436.5" y="978.9106">2003</text><polygon fill="#A80036" points="1467,1024.2422,1477,1028.2422,1467,1032.2422,1471,1028.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1249" x2="1473" y1="1028.2422" y2="1028.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1256" y="1015.6099">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1274" y="1008.0435">Request to retrieve</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="1274" y="1023.1763">transferFulfilment &amp; transferState</text><polygon fill="#FFFFE0" filter="url(#f1astixi91bswf)" points="1422,1041.2422,1546,1041.2422,1556,1060.2422,1546,1079.2422,1422,1079.2422,1412,1060.2422,1422,1041.2422" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1424" y="1057.3091">transferFulfilment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1424" y="1072.4419">transferStateChange</text><polygon fill="#A80036" points="1260,1116.7734,1250,1120.7734,1260,1124.7734,1256,1120.7734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1254" x2="1483" y1="1120.7734" y2="1120.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1266" y="1108.1411">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="1284" y="1100.5747">Return transferFulfilment &amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="1284" y="1115.7075">transferState</text><polygon fill="#A80036" points="348.5,1145.9063,338.5,1149.9063,348.5,1153.9063,344.5,1149.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="1243" y1="1149.9063" y2="1149.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="354.5" y="1144.8403">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="372.5" y="1144.8403">Return Transfer Fulfilment &amp; Transfer state</text><path d="M257,1164.9063 L320,1164.9063 L320,1171.9063 L310,1181.9063 L257,1181.9063 L257,1164.9063 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="2331.8281" style="stroke: #000000; stroke-width: 2.0;" width="961.5" x="257" y="1164.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="272" y="1177.9731">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="169" x="335" y="1177.1167">[transferFulfilment.isValid == 0]</text><path d="M267,1189.0391 L350,1189.0391 L350,1196.0391 L340,1206.0391 L267,1206.0391 L267,1189.0391 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1001.1094" style="stroke: #000000; stroke-width: 2.0;" width="941.5" x="267" y="1189.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="282" y="1202.106">break</text><path d="M277,1213.1719 L340,1213.1719 L340,1220.1719 L330,1230.1719 L277,1230.1719 L277,1213.1719 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="969.9766" style="stroke: #000000; stroke-width: 2.0;" width="921.5" x="277" y="1213.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="292" y="1226.2388">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="355" y="1225.3823">[If type == 'fulfil']</text><path d="M342,1235.3047 L342,1608.3047 L621,1608.3047 L621,1245.3047 L611,1235.3047 L342,1235.3047 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,1235.3047 L611,1245.3047 L621,1245.3047 L611,1235.3047 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="1252.3716">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="1267.5044">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="1282.6372">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="1297.77">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="1312.9028">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="1328.0356">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="1343.1685">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="1358.3013">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="1373.4341">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="1388.5669">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="1403.6997">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="1418.8325">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="1433.9653">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="1449.0981">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="384" y="1464.231">type: notification,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="384" y="1479.3638">action: fulfil-duplicate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="1494.4966">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="1509.6294">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="396" y="1524.7622">status: "error",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="1539.895">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="1555.0278">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="1570.1606">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="1585.2935">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="1600.4263">}</text><polygon fill="#A80036" points="1124.5,1649.7578,1134.5,1653.7578,1124.5,1657.7578,1128.5,1653.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1130.5" y1="1653.7578" y2="1653.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="1641.1255">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="318" x="362.5" y="1633.5591">Publish Notification event for Payee - Modified Request</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="362.5" y="1648.6919">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="442.5" y="1648.6919">3106</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="277" x2="1198.5" y1="1692.7578" y2="1692.7578"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="282" y="1702.9683">[If type == 'bulk-fulfil']</text><path d="M342,1711.5625 L342,2084.5625 L621,2084.5625 L621,1721.5625 L611,1711.5625 L342,1711.5625 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,1711.5625 L611,1721.5625 L621,1721.5625 L611,1711.5625 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="1728.6294">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="1743.7622">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="1758.895">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="1774.0278">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="1789.1606">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="1804.2935">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="1819.4263">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="1834.5591">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="1849.6919">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="1864.8247">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="1879.9575">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="1895.0903">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="1910.2231">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="1925.356">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="384" y="1940.4888">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="384" y="1955.6216">action: fulfil-duplicate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="1970.7544">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="1985.8872">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="396" y="2001.02">status: "error",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="2016.1528">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="2031.2856">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="2046.4185">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="2061.5513">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="2076.6841">}</text><polygon fill="#A80036" points="1006,2141.1484,1016,2145.1484,1006,2149.1484,1010,2145.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1012" y1="2145.1484" y2="2145.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="2124.9497">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="318" x="362.5" y="2109.8169">Publish Notification event for Payee - Modified Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="362.5" y="2124.9497">3106 to Bulk Processing Topic</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="362.5" y="2140.0825">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="442.5" y="2140.0825">3106</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="257" x2="1218.5" y1="2198.1484" y2="2198.1484"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="241" x="262" y="2208.3589">[transferState IN ['COMMITTED', 'ABORTED']]</text><path d="M267,2218.9531 L350,2218.9531 L350,2225.9531 L340,2235.9531 L267,2235.9531 L267,2218.9531 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="584.9219" style="stroke: #000000; stroke-width: 2.0;" width="941.5" x="267" y="2218.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="282" y="2232.02">break</text><path d="M277,2243.0859 L340,2243.0859 L340,2250.0859 L330,2260.0859 L277,2260.0859 L277,2243.0859 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="553.7891" style="stroke: #000000; stroke-width: 2.0;" width="921.5" x="277" y="2243.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="292" y="2256.1528">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="355" y="2255.2964">[If type == 'fulfil']</text><rect fill="#FFFFFF" filter="url(#f1astixi91bswf)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="903.5" x="284" y="2260.2188"/><polygon fill="#EEEEEE" points="284,2260.2188,348,2260.2188,348,2267.2188,338,2277.2188,284,2277.2188,284,2260.2188" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="297" y="2274.2856">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="625.75" y="2293.2856">Send notification to Participant (Payee)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="628.75" y="2308.4185"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="277" x2="1198.5" y1="2321.6172" y2="2321.6172"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="282" y="2331.8276">[If type == 'bulk-fulfil']</text><path d="M342,2340.4219 L342,2713.4219 L621,2713.4219 L621,2350.4219 L611,2340.4219 L342,2340.4219 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,2340.4219 L611,2350.4219 L621,2350.4219 L611,2340.4219 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="2357.4888">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="2372.6216">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="2387.7544">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="2402.8872">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="2418.02">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="2433.1528">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="2448.2856">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="2463.4185">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="2478.5513">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="2493.6841">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="2508.8169">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="2523.9497">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="2539.0825">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="2554.2153">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="384" y="2569.3481">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="384" y="2584.481">action: fulfil-duplicate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="2599.6138">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="2614.7466">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="396" y="2629.8794">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="2645.0122">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="2660.145">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="2675.2778">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="2690.4106">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="2705.5435">}</text><polygon fill="#A80036" points="1006,2754.875,1016,2758.875,1006,2762.875,1010,2758.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1012" y1="2758.875" y2="2758.875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="2746.2427">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="349" x="362.5" y="2738.6763">Publish Notification event for Payee to Bulk Processing Topic</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="362.5" y="2753.8091">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="442.5" y="2753.8091">2003</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="257" x2="1218.5" y1="2811.875" y2="2811.875"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="168" x="262" y="2822.0854">[transferState NOT 'RESERVED']</text><path d="M277,2832.6797 L360,2832.6797 L360,2839.6797 L350,2849.6797 L277,2849.6797 L277,2832.6797 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="298.5" x="277" y="2832.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="292" y="2845.7466">break</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="2886.0781" y2="2886.0781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="2886.0781" y2="2899.0781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="2899.0781" y2="2899.0781"/><polygon fill="#A80036" points="348.5,2895.0781,338.5,2899.0781,348.5,2903.0781,344.5,2899.0781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="2873.4458">17</text><text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="362.5" y="2865.8794">Reference: Failure in validation</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="362.5" y="2881.0122">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="436.5" y="2881.0122">2001</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="257" x2="1218.5" y1="2915.0781" y2="2915.0781"/><path d="M267,2923.0781 L350,2923.0781 L350,2930.0781 L340,2940.0781 L267,2940.0781 L267,2923.0781 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="566.6563" style="stroke: #000000; stroke-width: 2.0;" width="837.5" x="267" y="2923.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="282" y="2936.145">break</text><path d="M277,2947.2109 L340,2947.2109 L340,2954.2109 L330,2964.2109 L277,2964.2109 L277,2947.2109 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="535.5234" style="stroke: #000000; stroke-width: 2.0;" width="817.5" x="277" y="2947.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="292" y="2960.2778">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="355" y="2959.4214">[If type == 'fulfil']</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="2985.4766" y2="2985.4766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="2985.4766" y2="2998.4766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="2998.4766" y2="2998.4766"/><polygon fill="#A80036" points="348.5,2994.4766,338.5,2998.4766,348.5,3002.4766,344.5,2998.4766" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="2980.4106">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="362.5" y="2980.4106">Allow previous request to complete</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="277" x2="1094.5" y1="3007.4766" y2="3007.4766"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="282" y="3017.687">[If type == 'bulk-fulfil']</text><path d="M342,3026.2813 L342,3399.2813 L621,3399.2813 L621,3036.2813 L611,3026.2813 L342,3026.2813 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,3026.2813 L611,3036.2813 L621,3036.2813 L611,3026.2813 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="3043.3481">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="3058.481">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="3073.6138">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="3088.7466">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="3103.8794">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="3119.0122">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="3134.145">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="3149.2778">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="3164.4106">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="3179.5435">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="3194.6763">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="3209.8091">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="3224.9419">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="3240.0747">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="384" y="3255.2075">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="384" y="3270.3403">action: fulfil-duplicate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="3285.4731">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="3300.606">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="396" y="3315.7388">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="3330.8716">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="3346.0044">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="3361.1372">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="3376.27">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="3391.4028">}</text><polygon fill="#A80036" points="1006,3440.7344,1016,3444.7344,1006,3448.7344,1010,3444.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1012" y1="3444.7344" y2="3444.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="3432.1021">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="349" x="362.5" y="3424.5356">Publish Notification event for Payee to Bulk Processing Topic</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="362.5" y="3439.6685">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="442.5" y="3439.6685">2003</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247" x2="1602" y1="3504.7344" y2="3504.7344"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="252" y="3514.9448">[Hash not matched]</text><polygon fill="#A80036" points="1227,3550.8047,1237,3554.8047,1227,3558.8047,1231,3554.8047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1233" y1="3554.8047" y2="3554.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="3542.1724">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="362.5" y="3534.606">Request to persist transfer hash</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="362.5" y="3549.7388">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="442.5" y="3549.7388">2003</text><polygon fill="#A80036" points="1467,3579.9375,1477,3583.9375,1467,3587.9375,1471,3583.9375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1249" x2="1473" y1="3583.9375" y2="3583.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1256" y="3578.8716">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="1274" y="3578.8716">Persist hash</text><polygon fill="#FFFFE0" filter="url(#f1astixi91bswf)" points="1385,3626.9375,1582,3626.9375,1592,3637.9375,1582,3649.9375,1385,3649.9375,1375,3637.9375,1385,3626.9375" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="1387" y="3643.0044">transferFulfilmentDuplicateCheck</text><polygon fill="#A80036" points="348.5,3672.2031,338.5,3676.2031,348.5,3680.2031,344.5,3676.2031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="1243" y1="3676.2031" y2="3676.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="354.5" y="3671.1372">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="372.5" y="3671.1372">Return success</text><path d="M257,3705.2031 L320,3705.2031 L320,3712.2031 L310,3722.2031 L257,3722.2031 L257,3705.2031 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1572.9922" style="stroke: #000000; stroke-width: 2.0;" width="1329" x="257" y="3705.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="272" y="3718.27">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="267" x="335" y="3717.4136">[action=='reject' call made on PUT /transfers/{ID}]</text><polygon fill="#A80036" points="1227,3754.6016,1237,3758.6016,1227,3762.6016,1231,3758.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1233" y1="3758.6016" y2="3758.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="3745.9692">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="362.5" y="3738.4028">Request information for the validate checks</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="362.5" y="3753.5356">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="436.5" y="3753.5356">2003</text><polygon fill="#A80036" points="1467,3783.7344,1477,3787.7344,1467,3791.7344,1471,3787.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1249" x2="1473" y1="3787.7344" y2="3787.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1256" y="3782.6685">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="1274" y="3782.6685">Fetch from database</text><polygon fill="#FFFFE0" filter="url(#f1astixi91bswf)" points="1459,3800.7344,1509,3800.7344,1519,3811.7344,1509,3823.7344,1459,3823.7344,1449,3811.7344,1459,3800.7344" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1461" y="3816.8013">transfer</text><polygon fill="#A80036" points="1260,3846,1250,3850,1260,3854,1256,3850" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1254" x2="1483" y1="3850" y2="3850"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1266" y="3844.9341">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1287" y="3844.9341"/><polygon fill="#A80036" points="348.5,3875.1328,338.5,3879.1328,348.5,3883.1328,344.5,3879.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="1243" y1="3879.1328" y2="3879.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="354.5" y="3874.0669">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="372.5" y="3874.0669">Return transfer</text><path d="M267,3894.1328 L330,3894.1328 L330,3901.1328 L320,3911.1328 L267,3911.1328 L267,3894.1328 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="555.1953" style="stroke: #000000; stroke-width: 2.0;" width="1301" x="267" y="3894.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="282" y="3907.1997">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="294" x="345" y="3906.3433">[Fulfilment present in the PUT /transfers/{ID} message]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="3947.5313" y2="3947.5313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="3947.5313" y2="3960.5313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="3960.5313" y2="3960.5313"/><polygon fill="#A80036" points="348.5,3956.5313,338.5,3960.5313,348.5,3964.5313,344.5,3960.5313" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="3934.8989">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="425" x="362.5" y="3927.3325">Validate that Transfer.ilpCondition = SHA-256 (content.payload.fulfilment)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="362.5" y="3942.4653">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="436.5" y="3942.4653">2001</text><path d="M277,3975.5313 L433,3975.5313 L433,3982.5313 L423,3992.5313 L277,3992.5313 L277,3975.5313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="197.9297" style="stroke: #000000; stroke-width: 2.0;" width="1281" x="277" y="3975.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="292" y="3988.5981">Persist fulfilment</text><polygon fill="#A80036" points="1227,4024.9297,1237,4028.9297,1227,4032.9297,1231,4028.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1233" y1="4028.9297" y2="4028.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="4016.2974">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="362.5" y="4008.731">Persist fulfilment with the result of the above check (transferFulfilment.isValid)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="362.5" y="4023.8638">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="436.5" y="4023.8638">2003</text><polygon fill="#A80036" points="1467,4054.0625,1477,4058.0625,1467,4062.0625,1471,4058.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1249" x2="1473" y1="4058.0625" y2="4058.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1256" y="4052.9966">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1274" y="4052.9966">Persist to database</text><polygon fill="#FFFFE0" filter="url(#f1astixi91bswf)" points="1430,4101.0625,1538,4101.0625,1548,4120.0625,1538,4139.0625,1430,4139.0625,1420,4120.0625,1430,4101.0625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1432" y="4117.1294">transferFulfilment</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="1432" y="4132.2622">transferExtension</text><polygon fill="#A80036" points="348.5,4161.4609,338.5,4165.4609,348.5,4169.4609,344.5,4165.4609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="1243" y1="4165.4609" y2="4165.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="354.5" y="4160.395">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="372.5" y="4160.395">Return success</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="267" x2="1568" y1="4181.4609" y2="4181.4609"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="320" x="272" y="4191.6714">[Fulfilment NOT present in the PUT /transfers/{ID} message]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="4231.5313" y2="4231.5313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="4231.5313" y2="4244.5313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="4244.5313" y2="4244.5313"/><polygon fill="#A80036" points="348.5,4240.5313,338.5,4244.5313,348.5,4248.5313,344.5,4244.5313" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="4218.8989">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="326" x="362.5" y="4211.3325">Validate that transfer fulfilment message to Abort is valid</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="362.5" y="4226.4653">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="436.5" y="4226.4653">2001</text><path d="M277,4259.5313 L438,4259.5313 L438,4266.5313 L428,4276.5313 L277,4276.5313 L277,4259.5313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="182.7969" style="stroke: #000000; stroke-width: 2.0;" width="1281" x="277" y="4259.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="292" y="4272.5981">Persist extensions</text><polygon fill="#A80036" points="1227,4308.9297,1237,4312.9297,1227,4316.9297,1231,4312.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1233" y1="4312.9297" y2="4312.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="4300.2974">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="362.5" y="4292.731">Persist extensionList elements</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="362.5" y="4307.8638">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="436.5" y="4307.8638">2003</text><polygon fill="#A80036" points="1467,4338.0625,1477,4342.0625,1467,4346.0625,1471,4342.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1249" x2="1473" y1="4342.0625" y2="4342.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1256" y="4336.9966">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1274" y="4336.9966">Persist to database</text><polygon fill="#FFFFE0" filter="url(#f1astixi91bswf)" points="1430,4385.0625,1538,4385.0625,1548,4396.0625,1538,4408.0625,1430,4408.0625,1420,4396.0625,1430,4385.0625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="1432" y="4401.1294">transferExtension</text><polygon fill="#A80036" points="348.5,4430.3281,338.5,4434.3281,348.5,4438.3281,344.5,4434.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="1243" y1="4434.3281" y2="4434.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="354.5" y="4429.2622">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="372.5" y="4429.2622">Return success</text><path d="M267,4463.3281 L330,4463.3281 L330,4470.3281 L320,4480.3281 L267,4480.3281 L267,4463.3281 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="374.3984" style="stroke: #000000; stroke-width: 2.0;" width="1309" x="267" y="4463.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="282" y="4476.395">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="401" x="345" y="4475.5386">[Transfer.ilpCondition validate successful OR generic validation successful]</text><path d="M277,4487.4609 L710,4487.4609 L710,4494.4609 L700,4504.4609 L277,4504.4609 L277,4487.4609 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="182.7969" style="stroke: #000000; stroke-width: 2.0;" width="1289" x="277" y="4487.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="388" x="292" y="4500.5278">Persist Transfer State (with transferState='RECEIVED_REJECT')</text><polygon fill="#A80036" points="1227,4536.8594,1237,4540.8594,1227,4544.8594,1231,4540.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1233" y1="4540.8594" y2="4540.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="4528.2271">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="362.5" y="4520.6606">Request to persist transfer state</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="362.5" y="4535.7935">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="436.5" y="4535.7935">2003</text><polygon fill="#A80036" points="1467,4565.9922,1477,4569.9922,1467,4573.9922,1471,4569.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1249" x2="1473" y1="4569.9922" y2="4569.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1256" y="4564.9263">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="1274" y="4564.9263">Persist transfer state</text><polygon fill="#FFFFE0" filter="url(#f1astixi91bswf)" points="1422,4612.9922,1546,4612.9922,1556,4623.9922,1546,4635.9922,1422,4635.9922,1412,4623.9922,1422,4612.9922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1424" y="4629.0591">transferStateChange</text><polygon fill="#A80036" points="348.5,4658.2578,338.5,4662.2578,348.5,4666.2578,344.5,4662.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="1238" y1="4662.2578" y2="4662.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="354.5" y="4657.1919">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="372.5" y="4657.1919">Return success</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="4713.5234" y2="4713.5234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="4713.5234" y2="4726.5234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="4726.5234" y2="4726.5234"/><polygon fill="#A80036" points="348.5,4722.5234,338.5,4726.5234,348.5,4730.5234,344.5,4726.5234" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="4700.8911">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="362.5" y="4693.3247">Route &amp; Publish Position event for Payer</text><text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="320" x="362.5" y="4708.4575">Reference: Publish Position Reject event for Payer</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="267" x2="1576" y1="4735.5234" y2="4735.5234"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="357" x="272" y="4745.7339">[Validate Fulfil Transfer not successful or Generic validation failed]</text><path d="M277,4756.3281 L360,4756.3281 L360,4763.3281 L350,4773.3281 L277,4773.3281 L277,4756.3281 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="298.5" x="277" y="4756.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="292" y="4769.395">break</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="4809.7266" y2="4809.7266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="4809.7266" y2="4822.7266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="4822.7266" y2="4822.7266"/><polygon fill="#A80036" points="348.5,4818.7266,338.5,4822.7266,348.5,4826.7266,344.5,4822.7266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="4797.0942">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="362.5" y="4789.5278">Publish event for Payee</text><text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="362.5" y="4804.6606">Reference: Failure in validation</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="257" x2="1586" y1="4845.7266" y2="4845.7266"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="167" x="262" y="4855.937">[action=='abort' Error callback]</text><path d="M267,4866.5313 L330,4866.5313 L330,4873.5313 L320,4883.5313 L267,4883.5313 L267,4866.5313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="404.6641" style="stroke: #000000; stroke-width: 2.0;" width="1309" x="267" y="4866.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="282" y="4879.5981">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="345" y="4878.7417">[Validation successful]</text><path d="M277,4890.6641 L711,4890.6641 L711,4897.6641 L701,4907.6641 L277,4907.6641 L277,4890.6641 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="213.0625" style="stroke: #000000; stroke-width: 2.0;" width="1289" x="277" y="4890.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="389" x="292" y="4903.731">Persist Transfer State (with transferState='RECEIVED_ERROR')</text><polygon fill="#A80036" points="1232,4940.0625,1242,4944.0625,1232,4948.0625,1236,4944.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1238" y1="4944.0625" y2="4944.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="4931.4302">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="362.5" y="4923.8638">Request to persist transfer state &amp; Error</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="362.5" y="4938.9966">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="436.5" y="4938.9966">2003</text><polygon fill="#A80036" points="1467,4969.1953,1477,4973.1953,1467,4977.1953,1471,4973.1953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1254" x2="1473" y1="4973.1953" y2="4973.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1261" y="4968.1294">41</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="1279" y="4968.1294">Persist transfer state &amp; Error</text><polygon fill="#FFFFE0" filter="url(#f1astixi91bswf)" points="1422,5016.1953,1546,5016.1953,1556,5042.1953,1546,5069.1953,1422,5069.1953,1412,5042.1953,1422,5016.1953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1424" y="5032.2622">transferStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="1424" y="5047.395">transferError</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="1424" y="5062.5278">transferExtension</text><polygon fill="#A80036" points="348.5,5091.7266,338.5,5095.7266,348.5,5099.7266,344.5,5095.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="342.5" x2="1243" y1="5095.7266" y2="5095.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="354.5" y="5090.6606">42</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="372.5" y="5090.6606">Return success</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="5146.9922" y2="5146.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="5146.9922" y2="5159.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="5159.9922" y2="5159.9922"/><polygon fill="#A80036" points="348.5,5155.9922,338.5,5159.9922,348.5,5163.9922,344.5,5159.9922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="5134.3599">43</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="362.5" y="5126.7935">Error callback validated</text><text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="364" x="362.5" y="5141.9263">Reference: Produce message for validated error callback</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="267" x2="1576" y1="5168.9922" y2="5168.9922"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="257" x="272" y="5179.2026">[Validate Transfer Error Message not successful]</text><path d="M277,5189.7969 L360,5189.7969 L360,5196.7969 L350,5206.7969 L277,5206.7969 L277,5189.7969 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="467.5" x="277" y="5189.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="292" y="5202.8638">break</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="379.5" y1="5243.1953" y2="5243.1953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379.5" x2="379.5" y1="5243.1953" y2="5256.1953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="379.5" y1="5256.1953" y2="5256.1953"/><polygon fill="#A80036" points="348.5,5252.1953,338.5,5256.1953,348.5,5260.1953,344.5,5256.1953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="5230.563">44</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="362.5" y="5222.9966">Notifications for failures</text><text fill="#FF00FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="370" x="362.5" y="5238.1294">Reference: Validate Transfer Error Message not successful</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1645" y1="5286.1953" y2="5286.1953"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="143" x="28" y="5296.4058">[Consume Batch Messages]</text><path d="M119,5305 L119,5330 L318,5330 L318,5315 L308,5305 L119,5305 " fill="#ADD8E6" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M308,5305 L308,5315 L318,5315 L308,5305 " fill="#ADD8E6" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="125" y="5322.0669">To be delivered by future story</text><path d="M267,5360.1328 L682,5360.1328 L682,5367.1328 L672,5377.1328 L267,5377.1328 L267,5360.1328 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="970.8438" style="stroke: #000000; stroke-width: 2.0;" width="941.5" x="267" y="5360.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="370" x="282" y="5373.1997">Reference: Validate Transfer Error Message not successful</text><path d="M277,5384.2656 L340,5384.2656 L340,5391.2656 L330,5401.2656 L277,5401.2656 L277,5384.2656 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="939.7109" style="stroke: #000000; stroke-width: 2.0;" width="921.5" x="277" y="5384.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="292" y="5397.3325">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="355" y="5396.4761">[If type == 'bulk-fulfil']</text><path d="M342,5406.3984 L342,5779.3984 L621,5779.3984 L621,5416.3984 L611,5406.3984 L342,5406.3984 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,5406.3984 L611,5416.3984 L621,5416.3984 L611,5406.3984 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="5423.4653">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="5438.5981">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="5453.731">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="5468.8638">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="5483.9966">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="5499.1294">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="5514.2622">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="5529.395">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="5544.5278">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="5559.6606">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="5574.7935">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="5589.9263">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="5605.0591">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="5620.1919">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="384" y="5635.3247">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="384" y="5650.4575">action: abort,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="5665.5903">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="5680.7231">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="396" y="5695.856">status: "error",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="5710.9888">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="5726.1216">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="5741.2544">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="5756.3872">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="5771.52">}</text><polygon fill="#A80036" points="1006,5820.8516,1016,5824.8516,1006,5828.8516,1010,5824.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1012" y1="5824.8516" y2="5824.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="5812.2192">45</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="345" x="362.5" y="5804.6528">Publish Processing event for Payee to Bulk Processing Topic</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="362.5" y="5819.7856">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="442.5" y="5819.7856">2003</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="277" x2="1198.5" y1="5863.8516" y2="5863.8516"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="282" y="5874.062">[If type == 'fulfil']</text><path d="M342,5882.6563 L342,6255.6563 L621,6255.6563 L621,5892.6563 L611,5882.6563 L342,5882.6563 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,5882.6563 L611,5892.6563 L621,5892.6563 L611,5882.6563 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="5899.7231">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="5914.856">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="5929.9888">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="5945.1216">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="5960.2544">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="5975.3872">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="5990.52">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="6005.6528">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="6020.7856">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="6035.9185">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="6051.0513">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="6066.1841">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="6081.3169">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="6096.4497">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="384" y="6111.5825">type: fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="384" y="6126.7153">action: abort,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="6141.8481">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="6156.981">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="396" y="6172.1138">status: "error",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="6187.2466">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="6202.3794">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="6217.5122">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="6232.645">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="6247.7778">}</text><polygon fill="#A80036" points="1124.5,6281.9766,1134.5,6285.9766,1124.5,6289.9766,1128.5,6285.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1130.5" y1="6285.9766" y2="6285.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="6280.9106">46</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="255" x="362.5" y="6280.9106">Route &amp; Publish Notification event for Payee</text><path d="M267,6344.9766 L676,6344.9766 L676,6351.9766 L666,6361.9766 L267,6361.9766 L267,6344.9766 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="955.7109" style="stroke: #000000; stroke-width: 2.0;" width="635.5" x="267" y="6344.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="364" x="282" y="6358.0435">Reference: Produce message for validated error callback</text><path d="M277,6369.1094 L340,6369.1094 L340,6376.1094 L330,6386.1094 L277,6386.1094 L277,6369.1094 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="924.5781" style="stroke: #000000; stroke-width: 2.0;" width="615.5" x="277" y="6369.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="292" y="6382.1763">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="355" y="6381.3198">[If type == 'bulk-fulfil']</text><path d="M342,6391.2422 L342,6764.2422 L621,6764.2422 L621,6401.2422 L611,6391.2422 L342,6391.2422 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,6391.2422 L611,6401.2422 L621,6401.2422 L611,6391.2422 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="6408.3091">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="6423.4419">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="6438.5747">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="6453.7075">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="6468.8403">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="6483.9731">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="6499.106">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="6514.2388">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="6529.3716">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="6544.5044">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="6559.6372">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="6574.77">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="6589.9028">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="6605.0356">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="384" y="6620.1685">type: bulk-position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="384" y="6635.3013">action: abort,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="6650.4341">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="6665.5669">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="396" y="6680.6997">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="6695.8325">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="6710.9653">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="6726.0981">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="6741.231">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="6756.3638">}</text><polygon fill="#A80036" points="801.5,6790.5625,811.5,6794.5625,801.5,6798.5625,805.5,6794.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="807.5" y1="6794.5625" y2="6794.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="6789.4966">47</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="362.5" y="6789.4966">Route &amp; Publish Position event for Payer</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="277" x2="892.5" y1="6833.5625" y2="6833.5625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="282" y="6843.7729">[If type == 'fulfil']</text><path d="M342,6852.3672 L342,7225.3672 L621,7225.3672 L621,6862.3672 L611,6852.3672 L342,6852.3672 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,6852.3672 L611,6862.3672 L621,6862.3672 L611,6852.3672 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="6869.4341">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="6884.5669">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="6899.6997">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="6914.8325">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="6929.9653">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="6945.0981">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="6960.231">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="6975.3638">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="6990.4966">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="7005.6294">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="7020.7622">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="7035.895">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="7051.0278">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="7066.1606">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="384" y="7081.2935">type: position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="384" y="7096.4263">action: abort,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="7111.5591">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="7126.6919">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="396" y="7141.8247">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="7156.9575">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="7172.0903">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="7187.2231">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="7202.356">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="7217.4888">}</text><polygon fill="#A80036" points="801.5,7251.6875,811.5,7255.6875,801.5,7259.6875,805.5,7255.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="807.5" y1="7255.6875" y2="7255.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="7250.6216">48</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="362.5" y="7250.6216">Route &amp; Publish Position event for Payer</text><path d="M267,7314.6875 L513,7314.6875 L513,7321.6875 L503,7331.6875 L267,7331.6875 L267,7314.6875 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="970.8438" style="stroke: #000000; stroke-width: 2.0;" width="941.5" x="267" y="7314.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="282" y="7327.7544">Reference: Failure in validation</text><path d="M277,7338.8203 L340,7338.8203 L340,7345.8203 L330,7355.8203 L277,7355.8203 L277,7338.8203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="939.7109" style="stroke: #000000; stroke-width: 2.0;" width="921.5" x="277" y="7338.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="292" y="7351.8872">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="355" y="7351.0308">[If type == 'bulk-fulfil']</text><path d="M342,7360.9531 L342,7733.9531 L621,7733.9531 L621,7370.9531 L611,7360.9531 L342,7360.9531 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,7360.9531 L611,7370.9531 L621,7370.9531 L611,7360.9531 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="7378.02">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="7393.1528">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="7408.2856">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="7423.4185">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="7438.5513">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="7453.6841">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="7468.8169">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="7483.9497">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="7499.0825">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="7514.2153">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="7529.3481">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="7544.481">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="7559.6138">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="7574.7466">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="384" y="7589.8794">type: bulk-processing,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="384" y="7605.0122">action: reject,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="7620.145">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="7635.2778">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="396" y="7650.4106">status: "error",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="7665.5435">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="7680.6763">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="7695.8091">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="7710.9419">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="7726.0747">}</text><polygon fill="#A80036" points="1006,7775.4063,1016,7779.4063,1006,7783.4063,1010,7779.4063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1012" y1="7779.4063" y2="7779.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="7766.7739">49</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="311" x="362.5" y="7759.2075">Publish processing event to the Bulk Processing Topic</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="362.5" y="7774.3403">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="442.5" y="7774.3403">2003</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="277" x2="1198.5" y1="7818.4063" y2="7818.4063"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="282" y="7828.6167">[If type == 'fulfil']</text><path d="M342,7837.2109 L342,8210.2109 L621,8210.2109 L621,7847.2109 L611,7837.2109 L342,7837.2109 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,7837.2109 L611,7847.2109 L621,7847.2109 L611,7837.2109 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="7854.2778">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="7869.4106">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="7884.5435">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="7899.6763">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="7914.8091">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="7929.9419">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="7945.0747">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="7960.2075">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="7975.3403">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="7990.4731">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="8005.606">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="8020.7388">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="8035.8716">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="8051.0044">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="384" y="8066.1372">type: fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="384" y="8081.27">action: reject,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="8096.4028">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="8111.5356">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="396" y="8126.6685">status: "error",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="8141.8013">code: 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="8156.9341">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="8172.0669">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="8187.1997">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="8202.3325">}</text><polygon fill="#A80036" points="1124.5,8236.5313,1134.5,8240.5313,1124.5,8244.5313,1128.5,8240.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="1130.5" y1="8240.5313" y2="8240.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="8235.4653">50</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="255" x="362.5" y="8235.4653">Route &amp; Publish Notification event for Payee</text><path d="M267,8299.5313 L632,8299.5313 L632,8306.5313 L622,8316.5313 L267,8316.5313 L267,8299.5313 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="955.7109" style="stroke: #000000; stroke-width: 2.0;" width="635.5" x="267" y="8299.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="320" x="282" y="8312.5981">Reference: Publish Position Reject event for Payer</text><path d="M277,8323.6641 L340,8323.6641 L340,8330.6641 L330,8340.6641 L277,8340.6641 L277,8323.6641 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="924.5781" style="stroke: #000000; stroke-width: 2.0;" width="615.5" x="277" y="8323.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="292" y="8336.731">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="355" y="8335.8745">[If type == 'bulk-fulfil']</text><path d="M342,8345.7969 L342,8718.7969 L621,8718.7969 L621,8355.7969 L611,8345.7969 L342,8345.7969 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,8345.7969 L611,8355.7969 L621,8355.7969 L611,8345.7969 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="8362.8638">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="8377.9966">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="8393.1294">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="8408.2622">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="8423.395">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="8438.5278">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="8453.6606">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="8468.7935">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="8483.9263">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="8499.0591">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="8514.1919">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="8529.3247">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="8544.4575">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="8559.5903">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="384" y="8574.7231">type: bulk-position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="384" y="8589.856">action: reject,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="8604.9888">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="8620.1216">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="396" y="8635.2544">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="8650.3872">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="8665.52">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="8680.6528">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="8695.7856">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="8710.9185">}</text><polygon fill="#A80036" points="801.5,8745.1172,811.5,8749.1172,801.5,8753.1172,805.5,8749.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="807.5" y1="8749.1172" y2="8749.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="8744.0513">51</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="362.5" y="8744.0513">Route &amp; Publish Position event for Payer</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="277" x2="892.5" y1="8788.1172" y2="8788.1172"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="282" y="8798.3276">[If type == 'fulfil']</text><path d="M342,8806.9219 L342,9179.9219 L621,9179.9219 L621,8816.9219 L611,8806.9219 L342,8806.9219 " fill="#FFFF00" filter="url(#f1astixi91bswf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M611,8806.9219 L611,8816.9219 L621,8816.9219 L611,8806.9219 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="348" y="8823.9888">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="8839.1216">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="360" y="8854.2544">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="360" y="8869.3872">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="360" y="8884.52">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="360" y="8899.6528">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="360" y="8914.7856">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="372" y="8929.9185">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="372" y="8945.0513">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="360" y="8960.1841">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="360" y="8975.3169">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="372" y="8990.4497">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="9005.5825">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="384" y="9020.7153">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="384" y="9035.8481">type: position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="384" y="9050.981">action: reject,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="384" y="9066.1138">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="384" y="9081.2466">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="396" y="9096.3794">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="396" y="9111.5122">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="384" y="9126.645">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="372" y="9141.7778">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="360" y="9156.9106">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="348" y="9172.0435">}</text><polygon fill="#A80036" points="801.5,9206.2422,811.5,9210.2422,801.5,9214.2422,805.5,9210.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="337.5" x2="807.5" y1="9210.2422" y2="9210.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="344.5" y="9205.1763">52</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="362.5" y="9205.1763">Route &amp; Publish Position event for Payer</text><!--
@startuml
title 2.2.2. Fulfil Handler Consume (Reject/Abort) (single message, includes individual transfers from Bulk)

autonumber

collections "topic-\nfulfil" as TOPIC_FULFIL
control "Fulfil Handler" as FULF_HANDLER
collections "topic-\nevent" as TOPIC_EVENT
collections "topic-\ntransfer-position" as TOPIC_TRANSFER_POSITION
collections "topic-\nnotification" as TOPIC_NOTIFICATIONS
collections "topic-\nbulk-processing" as TOPIC_BULK_PROCESSING
entity "Transfer DAO" as TRANS_DAO
database "Central Store" as DB
box "Central Service" #LightYellow
    participant TOPIC_FULFIL
    participant FULF_HANDLER
    participant TOPIC_TRANSFER_POSITION
    participant TOPIC_EVENT
    participant TOPIC_BULK_PROCESSING
    participant TOPIC_NOTIFICATIONS
    participant TRANS_DAO
    participant DB
end box
activate FULF_HANDLER
group Fulfil Handler Consume (Failure)
    alt Consume Single Message
        TOPIC_FULFIL <- FULF_HANDLER: Consume Fulfil event message for Payer
        activate TOPIC_FULFIL
        deactivate TOPIC_FULFIL
        break
            group Validate Event
                FULF_HANDLER <-> FULF_HANDLER: Validate event - Rule: type IN ['fulfil','bulk-fulfil'] && ( action IN ['reject','abort'] )\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            FULF_HANDLER -> TOPIC_EVENT: Publish event information
            ref over FULF_HANDLER, TOPIC_EVENT:  Event Handler Consume\n
        end
        group Validate FSPIOP-Signature
            |||
            ref over FULF_HANDLER, TOPIC_NOTIFICATIONS: Validate message.content.headers.**FSPIOP-Signature**\n<color #FF0000><b>Error codes:</b> 2001</color>
        end
        group Validate Transfer Fulfil Duplicate Check
            FULF_HANDLER -> FULF_HANDLER: Generate transferFulfilmentId uuid
            FULF_HANDLER -> TRANS_DAO: Request to retrieve transfer fulfilment hashes by transferId\n<color #FF0000><b>Error code:</b> 2003</color>
            activate TRANS_DAO
            TRANS_DAO -> DB: Request Transfer fulfilment \nduplicate message hashes
            hnote over DB #lightyellow
                SELET transferId, hash
                FROM **transferFulfilmentDuplicateCheck**
                WHERE transferId = request.params.id
            end note
            activate DB
            TRANS_DAO <- - DB: Return existing hashes
            deactivate DB
            TRANS_DAO - -> FULF_HANDLER: Return (list of) transfer fulfil messages hash(es)
            deactivate TRANS_DAO
            FULF_HANDLER -> FULF_HANDLER: Loop the list of returned hashes & compare \neach entry with the calculated message hash
            alt Hash matched
                FULF_HANDLER -> TRANS_DAO: Request to retrieve Transfer Fulfilment & Transfer state\n<color #FF0000><b>Error code:</b> 2003</color>
                activate TRANS_DAO
                TRANS_DAO -> DB: Request to retrieve \ntransferFulfilment & transferState
                hnote over DB #lightyellow
                    transferFulfilment
                    transferStateChange
                end note
                activate DB
                TRANS_DAO <- - DB: Return transferFulfilment & \ntransferState
                deactivate DB
                TRANS_DAO - -> FULF_HANDLER: Return Transfer Fulfilment & Transfer state
                deactivate TRANS_DAO
                alt transferFulfilment.isValid == 0
                    break
                        alt If type == 'fulfil'
                            note right of FULF_HANDLER #yellow
                            Message:
                            {
                                id: <ID>,
                                from: <transferHeaders.FSPIOP-Source>,
                                to: <transferHeaders.FSPIOP-Destination>,
                                type: application/json,
                                content: {
                                    headers: <transferHeaders>,
                                    payload: <transferMessage>
                                },
                                metadata: {
                                    event: {
                                        id: <uuid>,
                                        responseTo: <previous.uuid>,
                                        type: notification,
                                        action: fulfil-duplicate,
                                        createdAt: <timestamp>,
                                        state: {
                                            status: "error",
                                            code: 1
                                        }
                                    }
                                }
                            }
                            end note
                            FULF_HANDLER -> TOPIC_NOTIFICATIONS: Publish Notification event for Payee - Modified Request\n<color #FF0000><b>Error codes:</b> 3106</color>
                            activate TOPIC_NOTIFICATIONS
                            deactivate TOPIC_NOTIFICATIONS
                        else If type == 'bulk-fulfil'
                            note right of FULF_HANDLER #yellow
                            Message:
                            {
                                id: <ID>,
                                from: <transferHeaders.FSPIOP-Source>,
                                to: <transferHeaders.FSPIOP-Destination>,
                                type: application/json,
                                content: {
                                    headers: <transferHeaders>,
                                    payload: <transferMessage>
                                },
                                metadata: {
                                    event: {
                                        id: <uuid>,
                                        responseTo: <previous.uuid>,
                                        type: bulk-processing,
                                        action: fulfil-duplicate,
                                        createdAt: <timestamp>,
                                        state: {
                                            status: "error",
                                            code: 1
                                        }
                                    }
                                }
                            }
                            end note
                            FULF_HANDLER -> TOPIC_BULK_PROCESSING: Publish Notification event for Payee - Modified Request \n3106 to Bulk Processing Topic\n<color #FF0000><b>Error codes:</b> 3106</color>
                            activate TOPIC_BULK_PROCESSING
                            deactivate TOPIC_BULK_PROCESSING
                        end
                    end
                else transferState IN ['COMMITTED', 'ABORTED']
                    break
                        alt If type == 'fulfil'
                            ref over FULF_HANDLER, TOPIC_NOTIFICATIONS: Send notification to Participant (Payee)\n
                        else If type == 'bulk-fulfil'
                            note right of FULF_HANDLER #yellow
                            Message:
                            {
                                id: <ID>,
                                from: <transferHeaders.FSPIOP-Source>,
                                to: <transferHeaders.FSPIOP-Destination>,
                                type: application/json,
                                content: {
                                    headers: <transferHeaders>,
                                    payload: <transferMessage>
                                },
                                metadata: {
                                    event: {
                                        id: <uuid>,
                                        responseTo: <previous.uuid>,
                                        type: bulk-processing,
                                        action: fulfil-duplicate,
                                        createdAt: <timestamp>,
                                        state: {
                                            status: "success",
                                            code: 0
                                        }
                                    }
                                }
                            }
                            end note
                            FULF_HANDLER -> TOPIC_BULK_PROCESSING: Publish Notification event for Payee to Bulk Processing Topic\n<color #FF0000><b>Error codes:</b> 2003</color>
                            activate TOPIC_BULK_PROCESSING
                            deactivate TOPIC_BULK_PROCESSING
                        end
                    end
                else transferState NOT 'RESERVED'
                    break
                        FULF_HANDLER <-> FULF_HANDLER: <color Magenta><b>Reference: Failure in validation</b></color>\n<color #FF0000><b>Error code:</b> 2001</color>
                    end
                else
                    break
                        alt If type == 'fulfil'
                            FULF_HANDLER <-> FULF_HANDLER: Allow previous request to complete
                        else If type == 'bulk-fulfil'
                            note right of FULF_HANDLER #yellow
                            Message:
                            {
                                id: <ID>,
                                from: <transferHeaders.FSPIOP-Source>,
                                to: <transferHeaders.FSPIOP-Destination>,
                                type: application/json,
                                content: {
                                    headers: <transferHeaders>,
                                    payload: <transferMessage>
                                },
                                metadata: {
                                    event: {
                                        id: <uuid>,
                                        responseTo: <previous.uuid>,
                                        type: bulk-processing,
                                        action: fulfil-duplicate,
                                        createdAt: <timestamp>,
                                        state: {
                                            status: "success",
                                            code: 0
                                        }
                                    }
                                }
                            }
                            end note
                            FULF_HANDLER -> TOPIC_BULK_PROCESSING: Publish Notification event for Payee to Bulk Processing Topic\n<color #FF0000><b>Error codes:</b> 2003</color>
                            activate TOPIC_BULK_PROCESSING
                            deactivate TOPIC_BULK_PROCESSING
                        end
                    end
                end
            else Hash not matched
                FULF_HANDLER -> TRANS_DAO: Request to persist transfer hash\n<color #FF0000><b>Error codes:</b> 2003</color>
                activate TRANS_DAO
                TRANS_DAO -> DB: Persist hash
                hnote over DB #lightyellow
                    transferFulfilmentDuplicateCheck
                end note
                activate DB
                deactivate DB
                TRANS_DAO - -> FULF_HANDLER: Return success
                deactivate TRANS_DAO
            end
        end
        alt action=='reject' call made on PUT /transfers/{ID}
            FULF_HANDLER -> TRANS_DAO: Request information for the validate checks\n<color #FF0000><b>Error code:</b> 2003</color>
            activate TRANS_DAO
            TRANS_DAO -> DB: Fetch from database
            activate DB
            hnote over DB #lightyellow
                transfer
            end note
            DB - -> TRANS_DAO
            deactivate DB
            FULF_HANDLER <- - TRANS_DAO: Return transfer
            deactivate TRANS_DAO

            alt Fulfilment present in the PUT /transfers/{ID} message
                FULF_HANDLER ->FULF_HANDLER: Validate that Transfer.ilpCondition = SHA-256 (content.payload.fulfilment)\n<color #FF0000><b>Error code:</b> 2001</color>

                group Persist fulfilment
                    FULF_HANDLER -> TRANS_DAO: Persist fulfilment with the result of the above check (transferFulfilment.isValid)\n<color #FF0000><b>Error code:</b> 2003</color>
                    activate TRANS_DAO
                    TRANS_DAO -> DB: Persist to database
                    activate DB
                    deactivate DB
                    hnote over DB #lightyellow
                        transferFulfilment
                        transferExtension
                    end note
                    FULF_HANDLER <- - TRANS_DAO: Return success
                    deactivate TRANS_DAO
                end
            else Fulfilment NOT present in the PUT /transfers/{ID} message
                FULF_HANDLER ->FULF_HANDLER: Validate that transfer fulfilment message to Abort is valid\n<color #FF0000><b>Error code:</b> 2001</color>
                group Persist extensions
                    FULF_HANDLER -> TRANS_DAO: Persist extensionList elements\n<color #FF0000><b>Error code:</b> 2003</color>
                    activate TRANS_DAO
                    TRANS_DAO -> DB: Persist to database
                    activate DB
                    deactivate DB
                    hnote over DB #lightyellow
                        transferExtension
                    end note
                    FULF_HANDLER <- - TRANS_DAO: Return success
                    deactivate TRANS_DAO
                end
            end

            alt Transfer.ilpCondition validate successful OR generic validation successful
                group Persist Transfer State (with transferState='RECEIVED_REJECT')
                    FULF_HANDLER -> TRANS_DAO: Request to persist transfer state\n<color #FF0000><b>Error code:</b> 2003</color>
                    activate TRANS_DAO
                    TRANS_DAO -> DB: Persist transfer state
                    activate DB
                    hnote over DB #lightyellow
                        transferStateChange
                    end note
                    deactivate DB
                    TRANS_DAO - -> FULF_HANDLER: Return success
                end

                FULF_HANDLER -> FULF_HANDLER: Route & Publish Position event for Payer\n<color Magenta><b>Reference: Publish Position Reject event for Payer</b></color>

            else Validate Fulfil Transfer not successful or Generic validation failed
                break
                    FULF_HANDLER -> FULF_HANDLER: Publish event for Payee\n<color Magenta><b>Reference: Failure in validation</b></color>
                end
            end
        else action=='abort' Error callback
            alt Validation successful
                group Persist Transfer State (with transferState='RECEIVED_ERROR')
                    FULF_HANDLER -> TRANS_DAO: Request to persist transfer state & Error\n<color #FF0000><b>Error code:</b> 2003</color>
                    activate TRANS_DAO
                    TRANS_DAO -> DB: Persist transfer state & Error
                    activate DB
                    hnote over DB #lightyellow
                        transferStateChange
                        transferError
                        transferExtension
                    end note
                    deactivate DB
                    TRANS_DAO - -> FULF_HANDLER: Return success
                end

                FULF_HANDLER -> FULF_HANDLER: Error callback validated\n<color Magenta><b>Reference: Produce message for validated error callback</b></color>

            else Validate Transfer Error Message not successful
                break
                    FULF_HANDLER -> FULF_HANDLER: Notifications for failures\n<color Magenta><b>Reference: Validate Transfer Error Message not successful</b></color>
                end
            end
        end
    else Consume Batch Messages
        note left of FULF_HANDLER #lightblue
            To be delivered by future story
        end note
    end
end

group Reference: Validate Transfer Error Message not successful
    alt If type == 'bulk-fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: bulk-processing,
                    action: abort,
                    createdAt: <timestamp>,
                    state: {
                        status: "error",
                        code: 1
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_BULK_PROCESSING: Publish Processing event for Payee to Bulk Processing Topic\n<color #FF0000><b>Error codes:</b> 2003</color>
        activate TOPIC_BULK_PROCESSING
        deactivate TOPIC_BULK_PROCESSING
    else If type == 'fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: fulfil,
                    action: abort,
                    createdAt: <timestamp>,
                    state: {
                        status: "error",
                        code: 1
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_NOTIFICATIONS: Route & Publish Notification event for Payee
        activate TOPIC_NOTIFICATIONS
        deactivate TOPIC_NOTIFICATIONS
    end
end

group Reference: Produce message for validated error callback
    alt If type == 'bulk-fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: bulk-position,
                    action: abort,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Route & Publish Position event for Payer
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
    else If type == 'fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: position,
                    action: abort,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Route & Publish Position event for Payer
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
    end
end

group Reference: Failure in validation
    alt If type == 'bulk-fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: bulk-processing,
                    action: reject,
                    createdAt: <timestamp>,
                    state: {
                        status: "error",
                        code: 1
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_BULK_PROCESSING: Publish processing event to the Bulk Processing Topic\n<color #FF0000><b>Error codes:</b> 2003</color>
        activate TOPIC_BULK_PROCESSING
        deactivate TOPIC_BULK_PROCESSING
    else If type == 'fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: fulfil,
                    action: reject,
                    createdAt: <timestamp>,
                    state: {
                        status: "error",
                        code: 1
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_NOTIFICATIONS: Route & Publish Notification event for Payee
        activate TOPIC_NOTIFICATIONS
        deactivate TOPIC_NOTIFICATIONS
    end
end

group Reference: Publish Position Reject event for Payer
    alt If type == 'bulk-fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: bulk-position,
                    action: reject,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Route & Publish Position event for Payer
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
    else If type == 'fulfil'
        note right of FULF_HANDLER #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: position,
                    action: reject,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
        end note
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Route & Publish Position event for Payer
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
    end
end

deactivate FULF_HANDLER
@enduml

PlantUML version 1.2018.02(Fri Mar 09 17:20:44 GMT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-b04
Operating System: Linux
OS Version: 4.15.0-1035-aws
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>