<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1303px" preserveAspectRatio="none" style="width:1337px;height:1303px;" version="1.1" viewBox="0 0 1337 1303" width="1337px" zoomAndPan="magnify"><defs><filter height="300%" id="f5ye3osvd9j9g" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="281" x="529.25" y="22.9951">5.1.1. Notification Handler for Rejections</text><rect fill="#D3D3D3" height="1258.5703" style="stroke: #A80036; stroke-width: 1.0;" width="178" x="4" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="172" x="7" y="46.3638">Financial Service Providers</text><rect fill="#ADD8E6" height="1258.5703" style="stroke: #A80036; stroke-width: 1.0;" width="230" x="256" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="149" x="296.5" y="46.3638">ML API Adapter Service</text><rect fill="#FFFFE0" height="1258.5703" style="stroke: #A80036; stroke-width: 1.0;" width="386" x="934.5" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="1078.5" y="46.3638">Central Service</text><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="1018.25" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="366" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1118.5" y="321.8203"/><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1118.5" y="1028.7422"/><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1244" y="223.4219"/><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="1003.25" style="stroke: #000000; stroke-width: 2.0;" width="1276.5" x="50" y="170.0234"/><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="136.6641" style="stroke: #000000; stroke-width: 2.0;" width="931.5" x="250" y="268.4219"/><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="747.1875" style="stroke: #000000; stroke-width: 2.0;" width="1121.5" x="60" y="419.0859"/><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="752" x="250" y="443.2188"/><rect fill="#FFFFFF" height="318.5313" style="stroke: none; stroke-width: 1.0;" width="1121.5" x="60" y="847.7422"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="93" x2="93" y1="153.0234" y2="1190.2734"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="371" x2="371" y1="153.0234" y2="1190.2734"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1001.5" x2="1001.5" y1="153.0234" y2="1190.2734"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1123.5" x2="1123.5" y1="153.0234" y2="1190.2734"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1248.5" x2="1248.5" y1="153.0234" y2="1190.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="70" y="133.4248">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="72.5" y="149.7217">Payer</text><ellipse cx="93" cy="63.4297" fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93,71.4297 L93,98.4297 M80,79.4297 L106,79.4297 M93,98.4297 L80,113.4297 M93,98.4297 L106,113.4297 " fill="none" filter="url(#f5ye3osvd9j9g)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="70" y="1202.2686">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="72.5" y="1218.5654">Payer</text><ellipse cx="93" cy="1231.8672" fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93,1239.8672 L93,1266.8672 M80,1247.8672 L106,1247.8672 M93,1266.8672 L80,1281.8672 M93,1266.8672 L106,1281.8672 " fill="none" filter="url(#f5ye3osvd9j9g)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="216" x="260" y="149.7217">ML API Notification Event Handler</text><ellipse cx="371" cy="120.7266" fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="367,108.7266,373,103.7266,371,108.7266,373,113.7266,367,108.7266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="216" x="260" y="1202.2686">ML API Notification Event Handler</text><ellipse cx="371" cy="1221.5703" fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="367,1209.5703,373,1204.5703,371,1209.5703,373,1214.5703,367,1209.5703" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="938.5" y="149.7217">Central Service API</text><path d="M981.5,108.7266 L981.5,132.7266 M981.5,120.7266 L998.5,120.7266 " fill="none" filter="url(#f5ye3osvd9j9g)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1010.5" cy="120.7266" fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="938.5" y="1202.2686">Central Service API</text><path d="M981.5,1209.5703 L981.5,1233.5703 M981.5,1221.5703 L998.5,1221.5703 " fill="none" filter="url(#f5ye3osvd9j9g)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1010.5" cy="1221.5703" fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="1079.5" y="113.7266"/><rect fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="1075.5" y="117.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="1082.5" y="137.7217">Event-Topic</text><rect fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="1079.5" y="1189.2734"/><rect fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="1075.5" y="1193.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="1082.5" y="1213.2686">Event-Topic</text><rect fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1185.5" y="113.7266"/><rect fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1181.5" y="117.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1188.5" y="137.7217">Notification-Topic</text><rect fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1185.5" y="1189.2734"/><rect fill="#FEFECE" filter="url(#f5ye3osvd9j9g)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1181.5" y="1193.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1188.5" y="1213.2686">Notification-Topic</text><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="1018.25" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="366" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1118.5" y="321.8203"/><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1118.5" y="1028.7422"/><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1244" y="223.4219"/><path d="M50,170.0234 L261,170.0234 L261,177.0234 L251,187.0234 L50,187.0234 L50,170.0234 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1003.25" style="stroke: #000000; stroke-width: 2.0;" width="1276.5" x="50" y="170.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="166" x="65" y="183.0903">DFSP Notified of Rejection</text><polygon fill="#A80036" points="1232,219.4219,1242,223.4219,1232,227.4219,1236,223.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="376" x2="1238" y1="223.4219" y2="223.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="383" y="210.7896">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="215" x="394" y="203.2231">Consume Notification event message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="397" y="218.356"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="397" y="218.356">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="471" y="218.356">2001</text><path d="M250,268.4219 L460,268.4219 L460,275.4219 L450,285.4219 L250,285.4219 L250,268.4219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="136.6641" style="stroke: #000000; stroke-width: 2.0;" width="931.5" x="250" y="268.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="265" y="281.4888">Persist Event Information</text><polygon fill="#A80036" points="1106.5,317.8203,1116.5,321.8203,1106.5,325.8203,1110.5,321.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="376" x2="1112.5" y1="321.8203" y2="321.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="383" y="309.188">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="394" y="301.6216">Publish event information</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="397" y="316.7544"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="397" y="316.7544">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="471" y="316.7544">3201</text><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="40.2656" style="stroke: #000000; stroke-width: 2.0;" width="130" x="1072.5" y="359.8203"/><polygon fill="#EEEEEE" points="1072.5,359.8203,1136.5,359.8203,1136.5,366.8203,1126.5,376.8203,1072.5,376.8203,1072.5,359.8203" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1085.5" y="373.8872">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="1078.5" y="392.8872">Event Handler {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="1168.5" y="392.8872">9.1.0</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1168.5" x2="1195.5" y1="394.8872" y2="394.8872"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1195.5" y="392.8872">}</text><path d="M60,419.0859 L123,419.0859 L123,426.0859 L113,436.0859 L60,436.0859 L60,419.0859 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="747.1875" style="stroke: #000000; stroke-width: 2.0;" width="1121.5" x="60" y="419.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="75" y="432.1528">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="138" y="431.2964">[consume a single messages]</text><path d="M250,443.2188 L388,443.2188 L388,450.2188 L378,460.2188 L250,460.2188 L250,443.2188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="59.2656" style="stroke: #000000; stroke-width: 2.0;" width="752" x="250" y="443.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="265" y="456.2856">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="376" x2="418" y1="481.4844" y2="481.4844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="418" x2="418" y1="481.4844" y2="494.4844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="377" x2="418" y1="494.4844" y2="494.4844"/><polygon fill="#A80036" points="387,490.4844,377,494.4844,387,498.4844,383,494.4844" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="383" y="476.4185">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="596" x="394" y="476.4185">Validate event - Rule: type == 'notification' &amp;&amp; [action IN ['reject', 'timeout-received', 'timeout-reserved']]</text><polygon fill="#A80036" points="990,541.75,1000,545.75,990,549.75,994,545.75" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="376" x2="996" y1="545.75" y2="545.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="383" y="533.1177">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="394" y="525.5513">Request Participant Callback details</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="397" y="540.6841"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="397" y="540.6841">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="471" y="540.6841">3201</text><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="40.2656" style="stroke: #000000; stroke-width: 2.0;" width="807.5" x="257" y="553.75"/><polygon fill="#EEEEEE" points="257,553.75,321,553.75,321,560.75,311,570.75,257,570.75,257,553.75" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="270" y="567.8169">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="553.75" y="586.8169">Get Participant Callback Details {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/participant/seq-callback-add-3.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/participant/seq-callback-add-3.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="739.75" y="586.8169">3.1.0</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="739.75" x2="766.75" y1="588.8169" y2="588.8169"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="766.75" y="586.8169">}</text><polygon fill="#A80036" points="387,616.1484,377,620.1484,387,624.1484,383,620.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="381" x2="1001" y1="620.1484" y2="620.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="393" y="615.0825">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="404" y="615.0825">Return Participant Callback details</text><path d="M78,633.1484 L78,794.1484 L357,794.1484 L357,643.1484 L347,633.1484 L78,633.1484 " fill="#FFFF00" filter="url(#f5ye3osvd9j9g)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M347,633.1484 L347,643.1484 L357,643.1484 L347,633.1484 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="84" y="650.2153">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="84" y="665.3481">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="96" y="680.481">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="96" y="695.6138">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="96" y="710.7466">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="96" y="725.8794">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="96" y="741.0122">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="108" y="756.145">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="96" y="771.2778">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="84" y="786.4106">}</text><polygon fill="#A80036" points="104,835.7422,94,839.7422,104,843.7422,100,839.7422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="98" x2="365" y1="839.7422" y2="839.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="110" y="827.1099">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="121" y="819.5435">Send Callback Notification</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="124" y="834.6763"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="124" y="834.6763">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="198" y="834.6763">1000, 1001, 3002</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="60" x2="1181.5" y1="848.7422" y2="848.7422"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="227" x="65" y="858.9526">[Validate rule type != 'notification' / Error]</text><path d="M381,867.5469 L381,982.5469 L637,982.5469 L637,877.5469 L627,867.5469 L381,867.5469 " fill="#FFFF00" filter="url(#f5ye3osvd9j9g)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M627,867.5469 L627,877.5469 L637,877.5469 L627,867.5469 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="387" y="884.6138">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="387" y="899.7466">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="399" y="914.8794">"errorInformation": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="411" y="930.0122">"errorCode": &lt;errorCode&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="411" y="945.145">"errorDescription": &lt;ErrorMessage&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="399" y="960.2778">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="387" y="975.4106">}</text><polygon fill="#A80036" points="1106.5,1024.7422,1116.5,1028.7422,1106.5,1032.7422,1110.5,1028.7422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="376" x2="1112.5" y1="1028.7422" y2="1028.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="383" y="1016.1099">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="313" x="394" y="1008.5435">Invalid messages retrieved from the Notification Topic</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="397" y="1023.6763"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="397" y="1023.6763">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="471" y="1023.6763">3201</text><rect fill="#FFFFFF" filter="url(#f5ye3osvd9j9g)" height="40.2656" style="stroke: #000000; stroke-width: 2.0;" width="130" x="1072.5" y="1066.7422"/><polygon fill="#EEEEEE" points="1072.5,1066.7422,1136.5,1066.7422,1136.5,1073.7422,1126.5,1083.7422,1072.5,1083.7422,1072.5,1066.7422" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1085.5" y="1080.8091">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="1078.5" y="1099.8091">Event Handler {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="1168.5" y="1099.8091">9.1.0</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1168.5" x2="1195.5" y1="1101.8091" y2="1101.8091"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1195.5" y="1099.8091">}</text><path d="M381,1117.0078 L381,1157.0078 L649,1157.0078 L649,1127.0078 L639,1117.0078 L381,1117.0078 " fill="#ADD8E6" filter="url(#f5ye3osvd9j9g)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M639,1117.0078 L639,1127.0078 L649,1127.0078 L639,1117.0078 " fill="#ADD8E6" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="387" y="1134.0747">Log ERROR Messages</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="387" y="1149.2075">Update Event log upon ERROR notification</text><!--
@startuml
title 5.1.1. Notification Handler for Rejections

autonumber



actor "DFSP1\nPayer" as DFSP1
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Event-Topic" as TOPIC_EVENT
collections "Notification-Topic" as TOPIC_NOTIFICATIONS

box "Financial Service Providers" #lightGray
	participant DFSP1
end box

box "ML API Adapter Service" #LightBlue
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
    participant TOPIC_EVENT
    participant TOPIC_NOTIFICATIONS
end box


group DFSP Notified of Rejection
    activate NOTIFY_HANDLER
        NOTIFY_HANDLER -> TOPIC_NOTIFICATIONS: Consume Notification event message \n <color #FF0000><b>Error code:</b> 2001 </color>
        activate TOPIC_NOTIFICATIONS
        deactivate TOPIC_NOTIFICATIONS
            group Persist Event Information
                NOTIFY_HANDLER -> TOPIC_EVENT: Publish event information \n <color #FF0000><b>Error code:</b> 3201 </color>
                activate TOPIC_EVENT
	            ref over TOPIC_EVENT :  Event Handler {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg 9.1.0]]}
                deactivate TOPIC_EVENT
            end

    alt consume a single messages
        group Validate Event
            NOTIFY_HANDLER <-> NOTIFY_HANDLER: Validate event - Rule: type == 'notification' && [action IN ['reject', 'timeout-received', 'timeout-reserved']]
        end
        NOTIFY_HANDLER -> CSAPI: Request Participant Callback details \n <color #FF0000><b>Error code:</b> 3201 </color>
        ref over NOTIFY_HANDLER, CSAPI: Get Participant Callback Details {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/participant/seq-callback-add-3.1.0.svg 3.1.0]]}
        NOTIFY_HANDLER <- - CSAPI: Return Participant Callback details
        note left of NOTIFY_HANDLER #yellow
            Message:
            {
                id: <ID>,
                from: <transferHeaders.FSPIOP-Source>,
                to: <transferHeaders.FSPIOP-Destination>,
                type: application/json,
                content: {
                    payload: <transferMessage>
                },
            }
        end note
        NOTIFY_HANDLER - -> DFSP1: Send Callback Notification \n <color #FF0000><b>Error code:</b> 1000, 1001, 3002 </color>
    else Validate rule type != 'notification' / Error
        note right of NOTIFY_HANDLER #yellow
            Message:
            {
                "errorInformation": {
                    "errorCode": <errorCode>,
                    "errorDescription": <ErrorMessage>,
                }
            }
        end note
        NOTIFY_HANDLER -> TOPIC_EVENT: Invalid messages retrieved from the Notification Topic \n <color #FF0000><b>Error code:</b> 3201 </color>
        activate TOPIC_EVENT
        deactivate TOPIC_EVENT
        ref over TOPIC_EVENT: Event Handler {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg 9.1.0]]}
        note right of NOTIFY_HANDLER #lightblue
            Log ERROR Messages
            Update Event log upon ERROR notification
        end note
    end
end
@enduml

PlantUML version 1.2018.02(Fri Mar 09 17:20:44 GMT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-b04
Operating System: Linux
OS Version: 4.15.0-1035-aws
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>