<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2158px" preserveAspectRatio="none" style="width:1943px;height:2158px;" version="1.1" viewBox="0 0 1943 2158" width="1943px" zoomAndPan="magnify"><defs><filter height="300%" id="fn9p16pjbl1j9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="503" x="721" y="22.9951">2.2.0.a. DFSP2 sends a PUT call on /error end-point for a Transfer request</text><rect fill="#D3D3D3" height="2112.875" style="stroke: #A80036; stroke-width: 1.0;" width="178" x="4" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="172" x="7" y="46.3638">Financial Service Providers</text><rect fill="#ADD8E6" height="2112.875" style="stroke: #A80036; stroke-width: 1.0;" width="464.5" x="383.5" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="149" x="541.25" y="46.3638">ML API Adapter Service</text><rect fill="#FFFFE0" height="2112.875" style="stroke: #A80036; stroke-width: 1.0;" width="1066" x="850" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="1334" y="46.3638">Central Service</text><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="589.1172" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="435" y="743.5391"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="1871.5547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="728" y="163.0234"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="86.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1032" y="1217.125"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="1871.5547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1361" y="163.0234"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="1871.5547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1686.5" y="163.0234"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="1857.5547" style="stroke: #000000; stroke-width: 2.0;" width="1910" x="22" y="170.0234"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="131.6641" style="stroke: #000000; stroke-width: 2.0;" width="1890" x="32" y="1664.1172"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="131.6641" style="stroke: #000000; stroke-width: 2.0;" width="1834" x="88" y="1863.9141"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="65" x2="65" y1="153.0234" y2="2044.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="121" x2="121" y1="153.0234" y2="2044.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="439.5" x2="439.5" y1="153.0234" y2="2044.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="733" x2="733" y1="153.0234" y2="2044.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="917" x2="917" y1="153.0234" y2="2044.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1037" x2="1037" y1="153.0234" y2="2044.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1366" x2="1366" y1="153.0234" y2="2044.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1523" x2="1523" y1="153.0234" y2="2044.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1691" x2="1691" y1="153.0234" y2="2044.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1844" x2="1844" y1="153.0234" y2="2044.5781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="42" y="133.4248">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="44.5" y="149.7217">Payer</text><ellipse cx="65" cy="63.4297" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M65,71.4297 L65,98.4297 M52,79.4297 L78,79.4297 M65,98.4297 L52,113.4297 M65,98.4297 L78,113.4297 " fill="none" filter="url(#fn9p16pjbl1j9)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="42" y="2056.5732">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="44.5" y="2072.8701">Payer</text><ellipse cx="65" cy="2086.1719" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M65,2094.1719 L65,2121.1719 M52,2102.1719 L78,2102.1719 M65,2121.1719 L52,2136.1719 M65,2121.1719 L78,2136.1719 " fill="none" filter="url(#fn9p16pjbl1j9)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="98" y="133.4248">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="99" y="149.7217">Payee</text><ellipse cx="121" cy="63.4297" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M121,71.4297 L121,98.4297 M108,79.4297 L134,79.4297 M121,98.4297 L108,113.4297 M121,98.4297 L134,113.4297 " fill="none" filter="url(#fn9p16pjbl1j9)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="98" y="2056.5732">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="99" y="2072.8701">Payee</text><ellipse cx="121" cy="2086.1719" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M121,2094.1719 L121,2121.1719 M108,2102.1719 L134,2102.1719 M121,2121.1719 L108,2136.1719 M121,2121.1719 L134,2136.1719 " fill="none" filter="url(#fn9p16pjbl1j9)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="387.5" y="149.7217">ML API Adapter</text><path d="M419.5,108.7266 L419.5,132.7266 M419.5,120.7266 L436.5,120.7266 " fill="none" filter="url(#fn9p16pjbl1j9)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="448.5" cy="120.7266" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="387.5" y="2056.5732">ML API Adapter</text><path d="M419.5,2063.875 L419.5,2087.875 M419.5,2075.875 L436.5,2075.875 " fill="none" filter="url(#fn9p16pjbl1j9)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="448.5" cy="2075.875" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="216" x="622" y="149.7217">ML API Notification Event Handler</text><ellipse cx="733" cy="120.7266" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="729,108.7266,735,103.7266,733,108.7266,735,113.7266,729,108.7266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="216" x="622" y="2056.5732">ML API Notification Event Handler</text><ellipse cx="733" cy="2075.875" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="729,2063.875,735,2058.875,733,2063.875,735,2068.875,729,2063.875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="854" y="149.7217">Central Service API</text><path d="M897,108.7266 L897,132.7266 M897,120.7266 L914,120.7266 " fill="none" filter="url(#fn9p16pjbl1j9)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="926" cy="120.7266" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="854" y="2056.5732">Central Service API</text><path d="M897,2063.875 L897,2087.875 M897,2075.875 L914,2075.875 " fill="none" filter="url(#fn9p16pjbl1j9)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="926" cy="2075.875" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="995" y="113.7266"/><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="991" y="117.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="998" y="137.7217">Fulfil-Topic</text><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="995" y="2043.5781"/><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="991" y="2047.5781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="998" y="2067.5732">Fulfil-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="1301" y="149.7217">Fulfil Event Handler</text><ellipse cx="1366" cy="120.7266" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1362,108.7266,1368,103.7266,1366,108.7266,1368,113.7266,1362,108.7266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="1301" y="2056.5732">Fulfil Event Handler</text><ellipse cx="1366" cy="2075.875" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1362,2063.875,1368,2058.875,1366,2063.875,1368,2068.875,1362,2063.875" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="1445" y="113.7266"/><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="1441" y="117.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="1448" y="137.7217">topic-transfer-position</text><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="1445" y="2043.5781"/><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="1441" y="2047.5781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="1448" y="2067.5732">topic-transfer-position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="1616" y="149.7217">Position Event Handler</text><ellipse cx="1691.5" cy="120.7266" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1687.5,108.7266,1693.5,103.7266,1691.5,108.7266,1693.5,113.7266,1687.5,108.7266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="1616" y="2056.5732">Position Event Handler</text><ellipse cx="1691.5" cy="2075.875" fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1687.5,2063.875,1693.5,2058.875,1691.5,2063.875,1693.5,2068.875,1687.5,2063.875" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1781" y="113.7266"/><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1777" y="117.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1784" y="137.7217">Notification-Topic</text><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1781" y="2043.5781"/><rect fill="#FEFECE" filter="url(#fn9p16pjbl1j9)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="1777" y="2047.5781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="1784" y="2067.5732">Notification-Topic</text><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="589.1172" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="435" y="743.5391"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="1871.5547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="728" y="163.0234"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="86.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1032" y="1217.125"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="1871.5547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1361" y="163.0234"/><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="1871.5547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1686.5" y="163.0234"/><path d="M22,170.0234 L351,170.0234 L351,177.0234 L341,187.0234 L22,187.0234 L22,170.0234 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1857.5547" style="stroke: #000000; stroke-width: 2.0;" width="1910" x="22" y="170.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="284" x="37" y="183.0903">DFSP2 sends a Fulfil Success Transfer request</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="163" y1="238.5547" y2="238.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="163" x2="163" y1="238.5547" y2="251.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="122" x2="163" y1="251.5547" y2="251.5547"/><polygon fill="#A80036" points="132,247.5547,122,251.5547,132,255.5547,128,251.5547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="128" y="218.356">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="139" y="203.2231">During processing of an incoming</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="139" y="218.356">POST /transfers request, some processing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="260" x="139" y="233.4888">error occurred and an Error callback is made</text><path d="M126,264.5547 L126,712.5547 L431,712.5547 L431,274.5547 L421,264.5547 L126,264.5547 " fill="#FFFF00" filter="url(#fn9p16pjbl1j9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M421,264.5547 L421,274.5547 L431,274.5547 L421,264.5547 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="132" y="281.6216">Headers - transferHeaders: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="144" y="296.7544">Content-Length: &lt;Content-Length&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="144" y="311.8872">Content-Type: &lt;Content-Type&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="144" y="327.02">Date: &lt;Date&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="144" y="342.1528">X-Forwarded-For: &lt;X-Forwarded-For&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="144" y="357.2856">FSPIOP-Source: &lt;FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="144" y="372.4185">FSPIOP-Destination: &lt;FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="144" y="387.5513">FSPIOP-Encryption: &lt;FSPIOP-Encryption&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="144" y="402.6841">FSPIOP-Signature: &lt;FSPIOP-Signature&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="144" y="417.8169">FSPIOP-URI: &lt;FSPIOP-URI&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="144" y="432.9497">FSPIOP-HTTP-Method: &lt;FSPIOP-HTTP-Method&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="132" y="448.0825">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="135" y="463.2153"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="132" y="478.3481">Payload - errorMessage:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="132" y="493.481">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="144" y="508.6138">errorInformation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="144" y="523.7466">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="156" y="538.8794">"errorCode": &lt;errorCode&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="156" y="554.0122">"errorDescription": &lt;errorDescription&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="156" y="569.145">"extensionList": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="168" y="584.2778">"extension": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="180" y="599.4106">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="192" y="614.5435">"key": &lt;string&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="192" y="629.6763">"value": &lt;string&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="180" y="644.8091">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="168" y="659.9419">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="156" y="675.0747">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="144" y="690.2075">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="132" y="705.3403">}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="433" x2="423" y1="743.5391" y2="739.5391"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="433" x2="423" y1="743.5391" y2="747.5391"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="434" y1="743.5391" y2="743.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="128" y="738.4731">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="139" y="738.4731">PUT - /transfers/&lt;ID&gt;/error</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="445" x2="487" y1="787.8047" y2="787.8047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="487" x2="487" y1="787.8047" y2="800.8047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="446" x2="487" y1="800.8047" y2="800.8047"/><polygon fill="#A80036" points="456,796.8047,446,800.8047,456,804.8047,452,800.8047" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="452" y="775.1724">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="463" y="767.606">Validate incoming originator matching Payee</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="463" y="782.7388">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="543" y="782.7388">3000-3002, 3100-3107</text><path d="M450,813.8047 L450,1171.8047 L729,1171.8047 L729,823.8047 L719,813.8047 L450,813.8047 " fill="#FFFF00" filter="url(#fn9p16pjbl1j9)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M719,813.8047 L719,823.8047 L729,823.8047 L719,813.8047 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="456" y="830.8716">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="456" y="846.0044">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="468" y="861.1372">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="468" y="876.27">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="468" y="891.4028">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="468" y="906.5356">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="468" y="921.6685">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="480" y="936.8013">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="480" y="951.9341">payload: &lt;errorMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="468" y="967.0669">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="468" y="982.1997">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="480" y="997.3325">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="492" y="1012.4653">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="492" y="1027.5981">type: fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="492" y="1042.731">action: abort,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="492" y="1057.8638">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="492" y="1072.9966">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="504" y="1088.1294">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="504" y="1103.2622">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="492" y="1118.395">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="480" y="1133.5278">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="468" y="1148.6606">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="456" y="1163.7935">}</text><polygon fill="#A80036" points="1020,1213.125,1030,1217.125,1020,1221.125,1024,1217.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="445" x2="1026" y1="1217.125" y2="1217.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="452" y="1204.4927">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="261" x="463" y="1196.9263">Route &amp; Publish Abort/Reject event for Payee</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="463" y="1212.0591">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="537" y="1212.0591">2003</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1042" x2="1084" y1="1261.3906" y2="1261.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1084" x2="1084" y1="1261.3906" y2="1274.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1043" x2="1084" y1="1274.3906" y2="1274.3906"/><polygon fill="#A80036" points="1053,1270.3906,1043,1274.3906,1053,1278.3906,1049,1274.3906" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="1049" y="1248.7583">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="1060" y="1241.1919">Ensure event is replicated as configured (ACKS=all)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="1060" y="1256.3247">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="1134" y="1256.3247">2003</text><polygon fill="#A80036" points="456,1299.5234,446,1303.5234,456,1307.5234,452,1303.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="450" x2="1036" y1="1303.5234" y2="1303.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="462" y="1298.4575">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="350" x="473" y="1298.4575">Respond replication acknowledgements have been received</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="131" y1="1332.6563" y2="1328.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="131" y1="1332.6563" y2="1336.6563"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="121" x2="439" y1="1332.6563" y2="1332.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="138" y="1327.5903">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="149" y="1327.5903">Respond HTTP - 200 (OK)</text><polygon fill="#A80036" points="1048,1357.7891,1038,1361.7891,1048,1365.7891,1044,1361.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1042" x2="1360" y1="1361.7891" y2="1361.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="1054" y="1356.7231">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1065" y="1356.7231">Consume message</text><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="617" x="988" y="1369.7891"/><polygon fill="#EEEEEE" points="988,1369.7891,1052,1369.7891,1052,1376.7891,1042,1386.7891,988,1386.7891,988,1369.7891" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1001" y="1383.856">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="228" x="1167" y="1402.856">Fulfil Handler Consume (Reject/Abort) {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-reject-2.2.1.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-reject-2.2.1.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="1395" y="1402.856">2.2.1</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1395" x2="1422" y1="1404.856" y2="1404.856"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1422" y="1402.856">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1170" y="1417.9888"/><polygon fill="#A80036" points="1511.5,1447.3203,1521.5,1451.3203,1511.5,1455.3203,1515.5,1451.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1371" x2="1517.5" y1="1451.3203" y2="1451.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="1378" y="1446.2544">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1389" y="1446.2544">Produce message</text><polygon fill="#A80036" points="1534.5,1501.4531,1524.5,1505.4531,1534.5,1509.4531,1530.5,1505.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1528.5" x2="1685.5" y1="1505.4531" y2="1505.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1540.5" y="1500.3872">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1558.5" y="1500.3872">Consume message</text><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="473" x="1438" y="1513.4531"/><polygon fill="#EEEEEE" points="1438,1513.4531,1502,1513.4531,1502,1520.4531,1492,1530.4531,1438,1530.4531,1438,1513.4531" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1451" y="1527.52">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="1555" y="1546.52">Position Handler Consume (Abort) {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.3-abort.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.3-abort.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="1763" y="1546.52">1.3.3</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1763" x2="1790" y1="1548.52" y2="1548.52"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1790" y="1546.52">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1558" y="1561.6528"/><polygon fill="#A80036" points="1832.5,1590.9844,1842.5,1594.9844,1832.5,1598.9844,1836.5,1594.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1696.5" x2="1838.5" y1="1594.9844" y2="1594.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1703.5" y="1589.9185">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1721.5" y="1589.9185">Produce message</text><polygon fill="#A80036" points="1832.5,1645.1172,1842.5,1649.1172,1832.5,1653.1172,1836.5,1649.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="738" x2="1838.5" y1="1649.1172" y2="1649.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="745" y="1644.0513">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="763" y="1644.0513">Consume message</text><path d="M32,1664.1172 L99,1664.1172 L99,1671.1172 L89,1681.1172 L32,1681.1172 L32,1664.1172 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="131.6641" style="stroke: #000000; stroke-width: 2.0;" width="1890" x="32" y="1664.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="47" y="1677.1841">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="114" y="1676.3276">[action == 'abort']</text><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="1872" x="39" y="1706.25"/><polygon fill="#EEEEEE" points="39,1706.25,103,1706.25,103,1713.25,93,1723.25,39,1723.25,39,1706.25" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="52" y="1720.3169">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="839.5" y="1739.3169">Send notification to Participant (Payer) {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="37" x="1069.5" y="1739.3169">1.1.4.a</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1069.5" x2="1106.5" y1="1741.3169" y2="1741.3169"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1106.5" y="1739.3169">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="842.5" y="1754.4497"/><polygon fill="#A80036" points="76,1783.7813,66,1787.7813,76,1791.7813,72,1787.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="70" x2="727" y1="1787.7813" y2="1787.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="82" y="1782.7153">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="100" y="1782.7153">Send callback notification</text><polygon fill="#A80036" points="1832.5,1844.9141,1842.5,1848.9141,1832.5,1852.9141,1836.5,1848.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="738" x2="1838.5" y1="1848.9141" y2="1848.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="745" y="1843.8481">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="763" y="1843.8481">Consume message</text><path d="M88,1863.9141 L155,1863.9141 L155,1870.9141 L145,1880.9141 L88,1880.9141 L88,1863.9141 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="131.6641" style="stroke: #000000; stroke-width: 2.0;" width="1834" x="88" y="1863.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="103" y="1876.981">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="170" y="1876.1245">[action == 'abort']</text><rect fill="#FFFFFF" filter="url(#fn9p16pjbl1j9)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="1816" x="95" y="1906.0469"/><polygon fill="#EEEEEE" points="95,1906.0469,159,1906.0469,159,1913.0469,149,1923.0469,95,1923.0469,95,1906.0469" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="108" y="1920.1138">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="866.5" y="1939.1138">Send notification to Participant (Payee) {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="37" x="1098.5" y="1939.1138">1.1.4.a</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="1098.5" x2="1135.5" y1="1941.1138" y2="1941.1138"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="1135.5" y="1939.1138">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="869.5" y="1954.2466"/><polygon fill="#A80036" points="132,1983.5781,122,1987.5781,132,1991.5781,128,1987.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126" x2="727" y1="1987.5781" y2="1987.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="138" y="1982.5122">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="156" y="1982.5122">Send callback notification</text><!--
@startuml
title 2.2.0.a. DFSP2 sends a PUT call on /error end-point for a Transfer request

autonumber

actor "DFSP1\nPayer" as DFSP1
actor "DFSP2\nPayee" as DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Fulfil-Topic" as TOPIC_FULFIL
control "Fulfil Event Handler" as FULF_HANDLER
collections "topic-transfer-position" as TOPIC_TRANSFER_POSITION
control "Position Event Handler" as POS_HANDLER
collections "Notification-Topic" as TOPIC_NOTIFICATIONS

box "Financial Service Providers" #lightGray
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightBlue
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
	participant TOPIC_FULFIL
    participant FULF_HANDLER
    participant TOPIC_TRANSFER_POSITION
    participant POS_HANDLER
    participant TOPIC_NOTIFICATIONS
end box

activate NOTIFY_HANDLER
activate FULF_HANDLER
activate POS_HANDLER
group DFSP2 sends a Fulfil Success Transfer request
    DFSP2 <-> DFSP2: During processing of an incoming\nPOST /transfers request, some processing\nerror occurred and an Error callback is made
    note right of DFSP2 #yellow
        Headers - transferHeaders: {
            Content-Length: <Content-Length>,
            Content-Type: <Content-Type>,
            Date: <Date>,
            X-Forwarded-For: <X-Forwarded-For>,
            FSPIOP-Source: <FSPIOP-Source>,
            FSPIOP-Destination: <FSPIOP-Destination>,
            FSPIOP-Encryption: <FSPIOP-Encryption>,
            FSPIOP-Signature: <FSPIOP-Signature>,
            FSPIOP-URI: <FSPIOP-URI>,
            FSPIOP-HTTP-Method: <FSPIOP-HTTP-Method>
        }

        Payload - errorMessage:
        {
            errorInformation
            {
                "errorCode": <errorCode>,
                "errorDescription": <errorDescription>
                "extensionList": {
                    "extension": [
                        {
                            "key": <string>,
                            "value": <string>
                        }
                    ]
                }
            }
        }
    end note
    DFSP2 ->> MLAPI: PUT - /transfers/<ID>/error
    activate MLAPI
    MLAPI -> MLAPI: Validate incoming originator matching Payee\n<color #FF0000><b>Error codes:</b> 3000-3002, 3100-3107</color>
    note right of MLAPI #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <transferHeaders>,
                payload: <errorMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    type: fulfil,
                    action: abort,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    MLAPI -> TOPIC_FULFIL: Route & Publish Abort/Reject event for Payee\n<color #FF0000><b>Error code:</b> 2003</color>
    activate TOPIC_FULFIL
    TOPIC_FULFIL <-> TOPIC_FULFIL: Ensure event is replicated as configured (ACKS=all)\n<color #FF0000><b>Error code:</b> 2003</color>
    TOPIC_FULFIL - -> MLAPI: Respond replication acknowledgements have been received
    deactivate TOPIC_FULFIL
    MLAPI - ->> DFSP2: Respond HTTP - 200 (OK)
    deactivate MLAPI
    TOPIC_FULFIL <- FULF_HANDLER: Consume message
    ref over TOPIC_FULFIL, TOPIC_TRANSFER_POSITION: Fulfil Handler Consume (Reject/Abort) {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-reject-2.2.1.svg 2.2.1]]} \n
    FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Produce message
    |||
    TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume message
    ref over TOPIC_TRANSFER_POSITION, TOPIC_NOTIFICATIONS:  Position Handler Consume (Abort) {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.3-abort.svg 1.3.3]]} \n
    POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    opt action == 'abort'
        |||
        ref over DFSP1, TOPIC_NOTIFICATIONS: Send notification to Participant (Payer) {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg 1.1.4.a]]} \n
        NOTIFY_HANDLER -> DFSP1: Send callback notification
    end
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    opt action == 'abort'
        |||
        ref over DFSP2, TOPIC_NOTIFICATIONS: Send notification to Participant (Payee) {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-prepare-1.1.4.a.svg 1.1.4.a]]} \n
        NOTIFY_HANDLER -> DFSP2: Send callback notification
    end
    |||
end
deactivate POS_HANDLER
deactivate FULF_HANDLER
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2018.02(Fri Mar 09 17:20:44 GMT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-b04
Operating System: Linux
OS Version: 4.15.0-1035-aws
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>