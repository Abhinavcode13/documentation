<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1682px" preserveAspectRatio="none" style="width:1115px;height:1682px;" version="1.1" viewBox="0 0 1115 1682" width="1115px" zoomAndPan="magnify"><defs><filter height="300%" id="fw5x5ukkt60vf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="619" x="249.25" y="22.9951">1.3.0. Position Handler Consume (single message, includes individual transfers from Bulk)</text><rect fill="#FFFFE0" height="1637.3125" style="stroke: #A80036; stroke-width: 1.0;" width="1059.5" x="29" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="509.75" y="46.3638">Central Service</text><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="110.5" y="181.125"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="110.5" y="659.7891"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="110.5" y="1138.4531"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="1498.5859" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="402.5" y="111.7266"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="1484.5859" style="stroke: #000000; stroke-width: 2.0;" width="1091.5" x="13" y="118.7266"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="1453.4531" style="stroke: #000000; stroke-width: 2.0;" width="1071.5" x="23" y="142.8594"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="105.5313" style="stroke: #000000; stroke-width: 2.0;" width="570" x="331.5" y="226.125"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="550" x="341.5" y="250.2578"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="608" x="341.5" y="345.6563"/><rect fill="#FFFFFF" height="478.6641" style="stroke: none; stroke-width: 1.0;" width="1071.5" x="23" y="623.8516"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="105.5313" style="stroke: #000000; stroke-width: 2.0;" width="566" x="331.5" y="704.7891"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="546" x="341.5" y="728.9219"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="608" x="341.5" y="824.3203"/><rect fill="#FFFFFF" height="493.7969" style="stroke: none; stroke-width: 1.0;" width="1071.5" x="23" y="1102.5156"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="120.6641" style="stroke: #000000; stroke-width: 2.0;" width="465" x="331.5" y="1183.4531"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="89.5313" style="stroke: #000000; stroke-width: 2.0;" width="445" x="341.5" y="1207.5859"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="608" x="341.5" y="1318.1172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="115" x2="115" y1="101.7266" y2="1620.3125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="407.5" x2="407.5" y1="101.7266" y2="1620.3125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="891.5" x2="891.5" y1="101.7266" y2="1620.3125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1016.5" x2="1016.5" y1="101.7266" y2="1620.3125"/><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="37" y="62.4297"/><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="33" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="40" y="86.4248">topic-transfer-position</text><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="37" y="1619.3125"/><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="33" y="1623.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="40" y="1643.3076">topic-transfer-position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="351.5" y="98.4248">Position Handler</text><ellipse cx="407.5" cy="69.4297" fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="403.5,57.4297,409.5,52.4297,407.5,57.4297,409.5,62.4297,403.5,57.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="351.5" y="1632.3076">Position Handler</text><ellipse cx="407.5" cy="1651.6094" fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="403.5,1639.6094,409.5,1634.6094,407.5,1639.6094,409.5,1644.6094,403.5,1639.6094" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="847.5" y="62.4297"/><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="843.5" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="850.5" y="86.4248">Event-Topic</text><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="847.5" y="1619.3125"/><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="843.5" y="1623.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="850.5" y="1643.3076">Event-Topic</text><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="953.5" y="62.4297"/><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="949.5" y="66.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="956.5" y="86.4248">Notification-Topic</text><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="953.5" y="1619.3125"/><rect fill="#FEFECE" filter="url(#fw5x5ukkt60vf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="127" x="949.5" y="1623.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="956.5" y="1643.3076">Notification-Topic</text><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="110.5" y="181.125"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="110.5" y="659.7891"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="110.5" y="1138.4531"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="1498.5859" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="402.5" y="111.7266"/><path d="M13,118.7266 L225,118.7266 L225,125.7266 L215,135.7266 L13,135.7266 L13,118.7266 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1484.5859" style="stroke: #000000; stroke-width: 2.0;" width="1091.5" x="13" y="118.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="167" x="28" y="131.7935">Position Handler Consume</text><path d="M23,142.8594 L86,142.8594 L86,149.8594 L76,159.8594 L23,159.8594 L23,142.8594 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1453.4531" style="stroke: #000000; stroke-width: 2.0;" width="1071.5" x="23" y="142.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="38" y="155.9263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="202" x="101" y="155.0698">[Consume Prepare message for Payer]</text><polygon fill="#A80036" points="131.5,177.125,121.5,181.125,131.5,185.125,127.5,181.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="125.5" x2="401.5" y1="181.125" y2="181.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="137.5" y="176.0591">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="148.5" y="176.0591">Consume Position event message for Payer</text><path d="M331.5,226.125 L414.5,226.125 L414.5,233.125 L404.5,243.125 L331.5,243.125 L331.5,226.125 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="105.5313" style="stroke: #000000; stroke-width: 2.0;" width="570" x="331.5" y="226.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="346.5" y="239.1919">break</text><path d="M341.5,250.2578 L479.5,250.2578 L479.5,257.2578 L469.5,267.2578 L341.5,267.2578 L341.5,250.2578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="550" x="341.5" y="250.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="356.5" y="263.3247">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="454.5" y1="303.6563" y2="303.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="454.5" x2="454.5" y1="303.6563" y2="316.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="413.5" x2="454.5" y1="316.6563" y2="316.6563"/><polygon fill="#A80036" points="423.5,312.6563,413.5,316.6563,423.5,320.6563,419.5,316.6563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="419.5" y="291.0239">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="449" x="430.5" y="283.4575">Validate event - Rule: type IN ['position','bulk-position'] &amp;&amp; action == 'prepare'</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="430.5" y="298.5903">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="510.5" y="298.5903">2001</text><path d="M341.5,345.6563 L551.5,345.6563 L551.5,352.6563 L541.5,362.6563 L341.5,362.6563 L341.5,345.6563 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="608" x="341.5" y="345.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="356.5" y="358.7231">Persist Event Information</text><polygon fill="#A80036" points="879.5,404.9219,889.5,408.9219,879.5,412.9219,883.5,408.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="885.5" y1="408.9219" y2="408.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="419.5" y="403.856">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="430.5" y="403.856">Publish event information</text><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="590" x="348.5" y="416.9219"/><polygon fill="#EEEEEE" points="348.5,416.9219,412.5,416.9219,412.5,423.9219,402.5,433.9219,348.5,433.9219,348.5,416.9219" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="361.5" y="430.9888">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="553.5" y="449.9888">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="702.5" y="449.9888">9.1.0</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="702.5" x2="729.5" y1="451.9888" y2="451.9888"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="729.5" y="449.9888">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="556.5" y="465.1216"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="256" x="348.5" y="534.3203"/><polygon fill="#EEEEEE" points="348.5,534.3203,412.5,534.3203,412.5,541.3203,402.5,551.3203,348.5,551.3203,348.5,534.3203" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="361.5" y="548.3872">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="354.5" y="567.3872">Prepare Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.1-prepare.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.1-prepare.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="567.5" y="567.3872">1.3.1</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="567.5" x2="594.5" y1="569.3872" y2="569.3872"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="594.5" y="567.3872">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="357.5" y="582.52"/><polygon fill="#A80036" points="1005,611.8516,1015,615.8516,1005,619.8516,1009,615.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="1011" y1="615.8516" y2="615.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="419.5" y="610.7856">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="430.5" y="610.7856">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1094.5" y1="624.8516" y2="624.8516"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="188" x="28" y="635.062">[Consume Fulfil message for Payee]</text><polygon fill="#A80036" points="131.5,655.7891,121.5,659.7891,131.5,663.7891,127.5,659.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="125.5" x2="401.5" y1="659.7891" y2="659.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="137.5" y="654.7231">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="148.5" y="654.7231">Consume Position event message for Payee</text><path d="M331.5,704.7891 L414.5,704.7891 L414.5,711.7891 L404.5,721.7891 L331.5,721.7891 L331.5,704.7891 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="105.5313" style="stroke: #000000; stroke-width: 2.0;" width="566" x="331.5" y="704.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="346.5" y="717.856">break</text><path d="M341.5,728.9219 L479.5,728.9219 L479.5,735.9219 L469.5,745.9219 L341.5,745.9219 L341.5,728.9219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.3984" style="stroke: #000000; stroke-width: 2.0;" width="546" x="341.5" y="728.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="356.5" y="741.9888">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="454.5" y1="782.3203" y2="782.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="454.5" x2="454.5" y1="782.3203" y2="795.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="413.5" x2="454.5" y1="795.3203" y2="795.3203"/><polygon fill="#A80036" points="423.5,791.3203,413.5,795.3203,423.5,799.3203,419.5,795.3203" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="419.5" y="769.688">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="445" x="430.5" y="762.1216">Validate event - Rule: type IN ['position','bulk-position'] &amp;&amp; action == 'commit'</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="430.5" y="777.2544">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="510.5" y="777.2544">2001</text><path d="M341.5,824.3203 L551.5,824.3203 L551.5,831.3203 L541.5,841.3203 L341.5,841.3203 L341.5,824.3203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="608" x="341.5" y="824.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="356.5" y="837.3872">Persist Event Information</text><polygon fill="#A80036" points="879.5,883.5859,889.5,887.5859,879.5,891.5859,883.5,887.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="885.5" y1="887.5859" y2="887.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="419.5" y="882.52">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="430.5" y="882.52">Publish event information</text><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="590" x="348.5" y="895.5859"/><polygon fill="#EEEEEE" points="348.5,895.5859,412.5,895.5859,412.5,902.5859,402.5,912.5859,348.5,912.5859,348.5,895.5859" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="361.5" y="909.6528">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="553.5" y="928.6528">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="702.5" y="928.6528">9.1.0</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="702.5" x2="729.5" y1="930.6528" y2="930.6528"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="729.5" y="928.6528">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="556.5" y="943.7856"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="237" x="348.5" y="1012.9844"/><polygon fill="#EEEEEE" points="348.5,1012.9844,412.5,1012.9844,412.5,1019.9844,402.5,1029.9844,348.5,1029.9844,348.5,1012.9844" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="361.5" y="1027.0513">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="354.5" y="1046.0513">Fulfil Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.2-fulfil.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.2-fulfil.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="548.5" y="1046.0513">1.3.2</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="548.5" x2="575.5" y1="1048.0513" y2="1048.0513"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="575.5" y="1046.0513">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="357.5" y="1061.1841"/><polygon fill="#A80036" points="1005,1090.5156,1015,1094.5156,1005,1098.5156,1009,1094.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="1011" y1="1094.5156" y2="1094.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="419.5" y="1089.4497">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="430.5" y="1089.4497">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1094.5" y1="1103.5156" y2="1103.5156"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="28" y="1113.7261">[Consume Abort message]</text><polygon fill="#A80036" points="131.5,1134.4531,121.5,1138.4531,131.5,1142.4531,127.5,1138.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="125.5" x2="401.5" y1="1138.4531" y2="1138.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="137.5" y="1133.3872">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="148.5" y="1133.3872">Consume Position event message</text><path d="M331.5,1183.4531 L414.5,1183.4531 L414.5,1190.4531 L404.5,1200.4531 L331.5,1200.4531 L331.5,1183.4531 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="120.6641" style="stroke: #000000; stroke-width: 2.0;" width="465" x="331.5" y="1183.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="346.5" y="1196.52">break</text><path d="M341.5,1207.5859 L479.5,1207.5859 L479.5,1214.5859 L469.5,1224.5859 L341.5,1224.5859 L341.5,1207.5859 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="89.5313" style="stroke: #000000; stroke-width: 2.0;" width="445" x="341.5" y="1207.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="356.5" y="1220.6528">Validate Event</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="454.5" y1="1276.1172" y2="1276.1172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="454.5" x2="454.5" y1="1276.1172" y2="1289.1172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="413.5" x2="454.5" y1="1289.1172" y2="1289.1172"/><polygon fill="#A80036" points="423.5,1285.1172,413.5,1289.1172,423.5,1293.1172,419.5,1289.1172" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="419.5" y="1255.9185">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="337" x="437.5" y="1240.7856">Validate event - Rule: type IN ['position','bulk-position'] &amp;&amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="437.5" y="1255.9185">action IN ['timeout-reserved', 'reject', 'fail']</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="437.5" y="1271.0513">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="517.5" y="1271.0513">2001</text><path d="M341.5,1318.1172 L551.5,1318.1172 L551.5,1325.1172 L541.5,1335.1172 L341.5,1335.1172 L341.5,1318.1172 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="156.6641" style="stroke: #000000; stroke-width: 2.0;" width="608" x="341.5" y="1318.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="356.5" y="1331.1841">Persist Event Information</text><polygon fill="#A80036" points="879.5,1377.3828,889.5,1381.3828,879.5,1385.3828,883.5,1381.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="885.5" y1="1381.3828" y2="1381.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="419.5" y="1376.3169">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="437.5" y="1376.3169">Publish event information</text><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="590" x="348.5" y="1389.3828"/><polygon fill="#EEEEEE" points="348.5,1389.3828,412.5,1389.3828,412.5,1396.3828,402.5,1406.3828,348.5,1406.3828,348.5,1389.3828" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="361.5" y="1403.4497">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="553.5" y="1422.4497">Event Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="702.5" y="1422.4497">9.1.0</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="702.5" x2="729.5" y1="1424.4497" y2="1424.4497"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="729.5" y="1422.4497">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="556.5" y="1437.5825"/><rect fill="#FFFFFF" filter="url(#fw5x5ukkt60vf)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="243" x="348.5" y="1506.7813"/><polygon fill="#EEEEEE" points="348.5,1506.7813,412.5,1506.7813,412.5,1513.7813,402.5,1523.7813,348.5,1523.7813,348.5,1506.7813" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="361.5" y="1520.8481">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="354.5" y="1539.8481">Abort Position Handler Consume {</text><a target="_top" xlink:actuate="onRequest" xlink:href="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.3-abort.svg" xlink:show="new" xlink:title="https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.3-abort.svg" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="27" x="554.5" y="1539.8481">1.3.3</text><line style="stroke: #0000FF; stroke-width: 1.0;" x1="554.5" x2="581.5" y1="1541.8481" y2="1541.8481"/></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="581.5" y="1539.8481">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="357.5" y="1554.981"/><polygon fill="#A80036" points="1005,1584.3125,1015,1588.3125,1005,1592.3125,1009,1588.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="1011" y1="1588.3125" y2="1588.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="419.5" y="1583.2466">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="437.5" y="1583.2466">Produce message</text><!--
@startuml
title 1.3.0. Position Handler Consume (single message, includes individual transfers from Bulk)

autonumber


collections "topic-transfer-position" as TOPIC_TRANSFER_POSITION
control "Position Handler" as POS_HANDLER
collections "Event-Topic" as TOPIC_EVENTS
collections "Notification-Topic" as TOPIC_NOTIFICATIONS


box "Central Service" #LightYellow
    participant TOPIC_TRANSFER_POSITION
    participant POS_HANDLER
    participant TOPIC_EVENTS
    participant TOPIC_NOTIFICATIONS
end box

activate POS_HANDLER
group Position Handler Consume
    alt Consume Prepare message for Payer
        TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume Position event message for Payer
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type IN ['position','bulk-position'] && action == 'prepare'\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg 9.1.0]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Prepare Position Handler Consume {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.1-prepare.svg 1.3.1]]} \n
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    else Consume Fulfil message for Payee
        TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume Position event message for Payee
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type IN ['position','bulk-position'] && action == 'commit'\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg 9.1.0]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Fulfil Position Handler Consume {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.2-fulfil.svg 1.3.2]]} \n
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    else Consume Abort message
        TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume Position event message
        activate TOPIC_TRANSFER_POSITION
        deactivate TOPIC_TRANSFER_POSITION
        break
            group Validate Event
                POS_HANDLER <-> POS_HANDLER: Validate event - Rule: type IN ['position','bulk-position'] &&\naction IN ['timeout-reserved', 'reject', 'fail']\n<color #FF0000><b>Error codes:</b> 2001</color>
            end
        end
        group Persist Event Information
            |||
            POS_HANDLER -> TOPIC_EVENTS: Publish event information
            ref over POS_HANDLER, TOPIC_EVENTS :  Event Handler Consume {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-event-9.1.0.svg 9.1.0]]} \n
            |||
        end
        |||
        ref over POS_HANDLER: Abort Position Handler Consume {[[https://github.com/mojaloop/docs/blob/master/Diagrams/SequenceDiagrams/seq-position-1.3.3-abort.svg 1.3.3]]} \n
        POS_HANDLER -> TOPIC_NOTIFICATIONS: Produce message
    end

end
deactivate POS_HANDLER
@enduml

PlantUML version 1.2018.02(Fri Mar 09 17:20:44 GMT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-b04
Operating System: Linux
OS Version: 4.15.0-1035-aws
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>