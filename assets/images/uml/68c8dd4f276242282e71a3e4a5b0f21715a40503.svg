<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1822px" preserveAspectRatio="none" style="width:1015px;height:1822px;" version="1.1" viewBox="0 0 1015 1822" width="1015px" zoomAndPan="magnify"><defs><filter height="300%" id="flayv05h0fi76" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="336" x="340.5" y="22.9951">6.2.4. Get Settlement By Id (getSettlementById)</text><rect fill="#FFB6C1" height="1776.8203" style="stroke: #A80036; stroke-width: 1.0;" width="107" x="64" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="79" y="46.3638">Central HUB</text><rect fill="#90EE90" height="1776.8203" style="stroke: #A80036; stroke-width: 1.0;" width="348" x="283" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123" x="395.5" y="46.3638">Settlement Service</text><rect fill="#FFFFE0" height="1776.8203" style="stroke: #A80036; stroke-width: 1.0;" width="110" x="674.5" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="677.5" y="46.3638">Central Services</text><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="1546.0938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="112.5" y="146.7266"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="1500.8281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="358.5" y="191.9922"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="181.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="566.5" y="236.2578"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="227.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="566.5" y="486.5859"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="227.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="566.5" y="758.1797"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="724.5" y="265.3906"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="724.5" y="515.7188"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="724.5" y="787.3125"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="1554.0938" style="stroke: #000000; stroke-width: 2.0;" width="992" x="12" y="153.7266"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="1267.6328" style="stroke: #000000; stroke-width: 2.0;" width="972" x="22" y="433.1875"/><rect fill="#FFFFFF" height="185.0625" style="stroke: none; stroke-width: 1.0;" width="972" x="22" y="1515.7578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="117" x2="117" y1="136.7266" y2="1724.8203"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="363" x2="363" y1="136.7266" y2="1724.8203"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="571" x2="571" y1="136.7266" y2="1724.8203"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="729.5" x2="729.5" y1="136.7266" y2="1724.8203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="68" y="133.4248">Hub Employee</text><ellipse cx="117.5" cy="63.4297" fill="#FEFECE" filter="url(#flayv05h0fi76)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M117.5,71.4297 L117.5,98.4297 M104.5,79.4297 L130.5,79.4297 M117.5,98.4297 L104.5,113.4297 M117.5,98.4297 L130.5,113.4297 " fill="none" filter="url(#flayv05h0fi76)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="68" y="1736.8154">Hub Employee</text><ellipse cx="117.5" cy="1750.1172" fill="#FEFECE" filter="url(#flayv05h0fi76)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M117.5,1758.1172 L117.5,1785.1172 M104.5,1766.1172 L130.5,1766.1172 M117.5,1785.1172 L104.5,1800.1172 M117.5,1785.1172 L130.5,1800.1172 " fill="none" filter="url(#flayv05h0fi76)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="147" x="287" y="133.4248">Settlement Service API</text><path d="M343,92.4297 L343,116.4297 M343,104.4297 L360,104.4297 " fill="none" filter="url(#flayv05h0fi76)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="372" cy="104.4297" fill="#FEFECE" filter="url(#flayv05h0fi76)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="147" x="287" y="1736.8154">Settlement Service API</text><path d="M343,1744.1172 L343,1768.1172 M343,1756.1172 L360,1756.1172 " fill="none" filter="url(#flayv05h0fi76)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="372" cy="1756.1172" fill="#FEFECE" filter="url(#flayv05h0fi76)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="516" y="133.4248">Settlement DAO</text><ellipse cx="571.5" cy="104.4297" fill="#FEFECE" filter="url(#flayv05h0fi76)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="559.5" x2="583.5" y1="118.4297" y2="118.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="516" y="1736.8154">Settlement DAO</text><ellipse cx="571.5" cy="1756.1172" fill="#FEFECE" filter="url(#flayv05h0fi76)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="559.5" x2="583.5" y1="1770.1172" y2="1770.1172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="685.5" y="133.4248">Central Store</text><path d="M711.5,84.4297 C711.5,74.4297 729.5,74.4297 729.5,74.4297 C729.5,74.4297 747.5,74.4297 747.5,84.4297 L747.5,110.4297 C747.5,120.4297 729.5,120.4297 729.5,120.4297 C729.5,120.4297 711.5,120.4297 711.5,110.4297 L711.5,84.4297 " fill="#FEFECE" filter="url(#flayv05h0fi76)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M711.5,84.4297 C711.5,94.4297 729.5,94.4297 729.5,94.4297 C729.5,94.4297 747.5,94.4297 747.5,84.4297 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="685.5" y="1736.8154">Central Store</text><path d="M711.5,1750.1172 C711.5,1740.1172 729.5,1740.1172 729.5,1740.1172 C729.5,1740.1172 747.5,1740.1172 747.5,1750.1172 L747.5,1776.1172 C747.5,1786.1172 729.5,1786.1172 729.5,1786.1172 C729.5,1786.1172 711.5,1786.1172 711.5,1776.1172 L711.5,1750.1172 " fill="#FEFECE" filter="url(#flayv05h0fi76)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M711.5,1750.1172 C711.5,1760.1172 729.5,1760.1172 729.5,1760.1172 C729.5,1760.1172 747.5,1760.1172 747.5,1750.1172 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="1546.0938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="112.5" y="146.7266"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="1500.8281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="358.5" y="191.9922"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="181.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="566.5" y="236.2578"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="227.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="566.5" y="486.5859"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="227.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="566.5" y="758.1797"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="724.5" y="265.3906"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="724.5" y="515.7188"/><rect fill="#FFFFFF" filter="url(#flayv05h0fi76)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="724.5" y="787.3125"/><path d="M12,153.7266 L191,153.7266 L191,160.7266 L181,170.7266 L12,170.7266 L12,153.7266 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1554.0938" style="stroke: #000000; stroke-width: 2.0;" width="992" x="12" y="153.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="134" x="27" y="166.7935">Get Settlement By Id</text><polygon fill="#A80036" points="346.5,187.9922,356.5,191.9922,346.5,195.9922,350.5,191.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="122.5" x2="352.5" y1="191.9922" y2="191.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="129.5" y="186.9263">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="140.5" y="186.9263">GET - /settlements/{id}</text><polygon fill="#A80036" points="554.5,232.2578,564.5,236.2578,554.5,240.2578,558.5,236.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="368.5" x2="560.5" y1="236.2578" y2="236.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="375.5" y="223.6255">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="386.5" y="216.0591">Request settlement state</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="386.5" y="231.1919">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="460.5" y="231.1919">2001</text><polygon fill="#A80036" points="712.5,261.3906,722.5,265.3906,712.5,269.3906,716.5,265.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="576.5" x2="718.5" y1="265.3906" y2="265.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="583.5" y="260.3247">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="594.5" y="260.3247">Retrieve settlement</text><polygon fill="#FFFFE0" filter="url(#flayv05h0fi76)" points="527,308.3906,931,308.3906,941,349.3906,931,391.3906,527,391.3906,517,349.3906,527,308.3906" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="400" x="529" y="324.4575">SELECT s.settlementId, ssc.settlementStateId, s.reason, s.createdDate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="529" y="339.5903">FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="567" y="339.5903">settlement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="6" x="642" y="339.5903">s</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="529" y="354.7231">JOIN</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="559" y="354.7231">settlementStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="716" y="354.7231">ssc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="343" x="529" y="369.856">ON ssc.settlementStateChangeId = s.currentStateChangeId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="529" y="384.9888">WHERE s.settlementId = {id}</text><polygon fill="#A80036" points="379.5,414.1875,369.5,418.1875,379.5,422.1875,375.5,418.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="373.5" x2="570.5" y1="418.1875" y2="418.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="385.5" y="413.1216">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="396.5" y="413.1216">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="439.5" y="413.1216">settlement</text><path d="M22,433.1875 L85,433.1875 L85,440.1875 L75,450.1875 L22,450.1875 L22,433.1875 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1267.6328" style="stroke: #000000; stroke-width: 2.0;" width="972" x="22" y="433.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="37" y="446.2544">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="100" y="445.3979">[settlement found]</text><polygon fill="#A80036" points="554.5,482.5859,564.5,486.5859,554.5,490.5859,558.5,486.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="368.5" x2="560.5" y1="486.5859" y2="486.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="375.5" y="473.9536">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="386.5" y="466.3872">Request settlement windows</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="386.5" y="481.52">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="460.5" y="481.52">2001</text><polygon fill="#A80036" points="712.5,511.7188,722.5,515.7188,712.5,519.7188,716.5,515.7188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="576.5" x2="718.5" y1="515.7188" y2="515.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="583.5" y="510.6528">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="594.5" y="510.6528">Retrieve windows</text><polygon fill="#FFFFE0" filter="url(#flayv05h0fi76)" points="522,558.7188,937,558.7188,947,622.7188,937,687.7188,522,687.7188,512,622.7188,522,558.7188" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="377" x="524" y="574.7856">SELECT sw.settlementWindowId, swsc.settlementWindowStateId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="545" y="589.9185">swsc.reason, sw.createdDate, swsc.createdDate changedDate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="524" y="605.0513">FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="195" x="562" y="605.0513">settlementSettlementWindow</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="22" x="760" y="605.0513">ssw</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="524" y="620.1841">JOIN</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="122" x="554" y="620.1841">settlementWindow</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="679" y="620.1841">sw</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="323" x="524" y="635.3169">ON sw.settlementWindowId = ssw.settlementWindowId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="524" y="650.4497">JOIN</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="204" x="554" y="650.4497">settlementWindowStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="761" y="650.4497">swsc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="411" x="524" y="665.5825">ON swsc.settlementWindowStateChangeId = sw.currentStateChangeId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="524" y="680.7153">WHERE ssw.settlementId = {id}</text><polygon fill="#A80036" points="379.5,709.9141,369.5,713.9141,379.5,717.9141,375.5,713.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="373.5" x2="570.5" y1="713.9141" y2="713.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="385.5" y="708.8481">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="396.5" y="708.8481">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="439.5" y="708.8481">windows</text><polygon fill="#A80036" points="554.5,754.1797,564.5,758.1797,554.5,762.1797,558.5,758.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="368.5" x2="560.5" y1="758.1797" y2="758.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="375.5" y="745.5474">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="386.5" y="737.981">Request settlement accounts</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="386.5" y="753.1138">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="460.5" y="753.1138">2001</text><polygon fill="#A80036" points="712.5,783.3125,722.5,787.3125,712.5,791.3125,716.5,787.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="576.5" x2="718.5" y1="787.3125" y2="787.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="583.5" y="782.2466">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="594.5" y="782.2466">Retrieve accounts</text><polygon fill="#FFFFE0" filter="url(#flayv05h0fi76)" points="484,830.3125,974,830.3125,984,894.3125,974,959.3125,484,959.3125,474,894.3125,484,830.3125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="443" x="486" y="846.3794">SELECT pc.participantId, spc.participantCurrencyId, spcsc.settlementStateId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="507" y="861.5122">spcsc.reason, spc.netAmount, pc.currencyId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="486" y="876.645">FROM</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="203" x="524" y="876.645">settlementParticipantCurrency</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="730" y="876.645">spc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="486" y="891.7778">JOIN</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="285" x="516" y="891.7778">settlementParticipantCurrencyStateChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="804" y="891.7778">spcsc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="486" x="486" y="906.9106">ON spcsc.settlementParticipantCurrencyStateChangeId = spc.currentStateChangeId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="486" y="922.0435">JOIN</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="516" y="922.0435">participantCurrency</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="14" x="650" y="922.0435">pc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="333" x="486" y="937.1763">ON pc.participantCurrencyId = spc.participantCurrencyId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="486" y="952.3091">WHERE spc.settlementId = {id}</text><polygon fill="#A80036" points="379.5,981.5078,369.5,985.5078,379.5,989.5078,375.5,985.5078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="373.5" x2="570.5" y1="985.5078" y2="985.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="385.5" y="980.4419">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="403.5" y="980.4419">Return</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="58" x="446.5" y="980.4419">accounts</text><path d="M32,998.5078 L32,1477.5078 L349,1477.5078 L349,1008.5078 L339,998.5078 L32,998.5078 " fill="#FFFF00" filter="url(#flayv05h0fi76)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M339,998.5078 L339,1008.5078 L349,1008.5078 L339,998.5078 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="38" y="1015.5747">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="50" y="1030.7075">"id": settlement.settlementId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="50" y="1045.8403">"state": settlement.settlementStateId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="50" y="1060.9731">"settlementWindows": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="62" y="1076.106">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="74" y="1091.2388">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="86" y="1106.3716">"id": window.settlementWindowId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="86" y="1121.5044">"reason": window.reason,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="86" y="1136.6372">"state": window.settlementWindowStateId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="86" y="1151.77">"createdDate": window.createdDate,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="86" y="1166.9028">"changedDate": window.changedDate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="74" y="1182.0356">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="62" y="1197.1685">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="50" y="1212.3013">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="50" y="1227.4341">"participants": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="62" y="1242.5669">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="74" y="1257.6997">"id": account.participantId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="74" y="1272.8325">"accounts": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="86" y="1287.9653">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="209" x="98" y="1303.0981">"id": account.participantCurrencyId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="98" y="1318.231">"reason": account.reason,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="98" y="1333.3638">"state": account.settlementStateId,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="98" y="1348.4966">"netSettlementAmount": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="110" y="1363.6294">"amount": account.netAmount,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="110" y="1378.7622">"currency": account.currencyId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="98" y="1393.895">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="86" y="1409.0278">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="74" y="1424.1606">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="62" y="1439.2935">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="50" y="1454.4263">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="38" y="1469.5591">}</text><polygon fill="#A80036" points="133.5,1503.7578,123.5,1507.7578,133.5,1511.7578,129.5,1507.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="127.5" x2="357.5" y1="1507.7578" y2="1507.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="139.5" y="1502.6919">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="157.5" y="1502.6919">Respond HTTP - 200 (OK)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="22" x2="994" y1="1516.7578" y2="1516.7578"/><path d="M373,1522.7578 L373,1547.7578 L494,1547.7578 L494,1532.7578 L484,1522.7578 L373,1522.7578 " fill="#D3D3D3" filter="url(#flayv05h0fi76)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M484,1522.7578 L484,1532.7578 L494,1532.7578 L484,1522.7578 " fill="#D3D3D3" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="379" y="1539.8247">Log ERROR event</text><path d="M46,1561.8906 L46,1661.8906 L349,1661.8906 L349,1571.8906 L339,1561.8906 L46,1561.8906 " fill="#FFFF00" filter="url(#flayv05h0fi76)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M339,1561.8906 L339,1571.8906 L349,1571.8906 L339,1561.8906 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="52" y="1578.9575">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="64" y="1594.0903">errorInformation: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="76" y="1609.2231">"errorCode": &lt;integer&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="258" x="76" y="1624.356">"errorDescription": "Client error description"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="64" y="1639.4888">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="52" y="1654.6216">}</text><polygon fill="#A80036" points="128.5,1688.8203,118.5,1692.8203,128.5,1696.8203,124.5,1692.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="122.5" x2="362.5" y1="1692.8203" y2="1692.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="134.5" y="1687.7544">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="152.5" y="1687.7544">Respond HTTP - 4xx (Client error)</text><!--
@startuml
title 6.2.4. Get Settlement By Id (getSettlementById)
autonumber

actor "Hub Employee" as OPERATOR
boundary "Settlement Service API" as SSAPI
entity "Settlement DAO" as SETTLE_DAO
database "Central Store" as DB

box "Central HUB" #lightpink
    participant OPERATOR
end box

box "Settlement Service" #lightgreen
    participant SSAPI
    participant SETTLE_DAO
end box

box "Central Services" #lightyellow
    participant DB
end box

group Get Settlement By Id
activate OPERATOR
    OPERATOR -> SSAPI: GET - /settlements/{id}
    activate SSAPI

    SSAPI-> SETTLE_DAO: Request settlement state\n<color #FF0000><b>Error code:</b> 2001</color>
    activate SETTLE_DAO
    SETTLE_DAO -> DB: Retrieve settlement
    activate DB
    hnote over DB #lightyellow
        SELECT s.settlementId, ssc.settlementStateId, s.reason, s.createdDate
        FROM **settlement** s
        JOIN **settlementStateChange** ssc
        ON ssc.settlementStateChangeId = s.currentStateChangeId
        WHERE s.settlementId = {id}
    end hnote
    deactivate DB
    SSAPI <- - SETTLE_DAO: Return **settlement**
    deactivate SETTLE_DAO

    alt settlement found
        SSAPI-> SETTLE_DAO: Request settlement windows\n<color #FF0000><b>Error code:</b> 2001</color>
        activate SETTLE_DAO
        SETTLE_DAO -> DB: Retrieve windows
        activate DB
        hnote over DB #lightyellow
            SELECT sw.settlementWindowId, swsc.settlementWindowStateId,
                   swsc.reason, sw.createdDate, swsc.createdDate changedDate
            FROM **settlementSettlementWindow** ssw
            JOIN **settlementWindow** sw
            ON sw.settlementWindowId = ssw.settlementWindowId
            JOIN **settlementWindowStateChange** swsc
            ON swsc.settlementWindowStateChangeId = sw.currentStateChangeId
            WHERE ssw.settlementId = {id}
        end hnote
        deactivate DB
        SSAPI <- - SETTLE_DAO: Return **windows**
        deactivate SETTLE_DAO

        SSAPI-> SETTLE_DAO: Request settlement accounts\n<color #FF0000><b>Error code:</b> 2001</color>
        activate SETTLE_DAO
        SETTLE_DAO -> DB: Retrieve accounts
        activate DB
        hnote over DB #lightyellow
            SELECT pc.participantId, spc.participantCurrencyId, spcsc.settlementStateId, 
                   spcsc.reason, spc.netAmount, pc.currencyId
            FROM **settlementParticipantCurrency** spc
            JOIN **settlementParticipantCurrencyStateChange** spcsc
            ON spcsc.settlementParticipantCurrencyStateChangeId = spc.currentStateChangeId
            JOIN **participantCurrency** pc
            ON pc.participantCurrencyId = spc.participantCurrencyId
            WHERE spc.settlementId = {id}
        end hnote
        deactivate DB
        SSAPI <- - SETTLE_DAO: Return **accounts**
        deactivate SETTLE_DAO

        deactivate SETTLE_DAO
        note left of SSAPI #yellow
            {
                "id": settlement.settlementId,
                "state": settlement.settlementStateId,
                "settlementWindows": [
                    [
                        {
                            "id": window.settlementWindowId,
                            "reason": window.reason,
                            "state": window.settlementWindowStateId,
                            "createdDate": window.createdDate,
                            "changedDate": window.changedDate
                        }
                    ]
                ],
                "participants": [
                    {
                        "id": account.participantId,
                        "accounts": [
                            {
                                "id": account.participantCurrencyId,
                                "reason": account.reason,
                                "state": account.settlementStateId,
                                "netSettlementAmount": {
                                    "amount": account.netAmount,
                                    "currency": account.currencyId
                                }
                            }
                        ]
                    }
                ]
            }
        end note
        OPERATOR <- - SSAPI: Respond HTTP - 200 (OK)
    else
        note right of SSAPI #lightgray
            Log ERROR event
        end note
        note left of SSAPI #yellow
            {
                errorInformation: {
                    "errorCode": <integer>,
                    "errorDescription": "Client error description"
                }
            }
        end note
        OPERATOR <- - SSAPI: Respond HTTP - 4xx (Client error)
        deactivate SSAPI
        deactivate OPERATOR
    end
end
@enduml

PlantUML version 1.2018.02(Fri Mar 09 17:20:44 GMT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-b04
Operating System: Linux
OS Version: 4.15.0-1035-aws
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>