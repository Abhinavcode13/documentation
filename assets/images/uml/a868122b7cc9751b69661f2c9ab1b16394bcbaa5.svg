<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="3223px" preserveAspectRatio="none" style="width:2463px;height:3223px;" version="1.1" viewBox="0 0 2463 3223" width="2463px" zoomAndPan="magnify"><defs><filter height="300%" id="f14be8qru47z29" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="385" x="1040" y="22.9951">2.1.0. DFSP2 sends a Bulk Fulfil Success Transfer request</text><rect fill="#D3D3D3" height="3177.8594" style="stroke: #A80036; stroke-width: 1.0;" width="178" x="4" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="172" x="7" y="46.3638">Financial Service Providers</text><rect fill="#ADD8E6" height="3177.8594" style="stroke: #A80036; stroke-width: 1.0;" width="368.5" x="284.5" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="149" x="394.25" y="46.3638">ML API Adapter Service</text><rect fill="#FFFFE0" height="3177.8594" style="stroke: #A80036; stroke-width: 1.0;" width="1736" x="700" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="1519" y="46.3638">Central Service</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="768.4453" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="336" y="883"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2936.5391" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="577" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="749" y="984.5313"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="44.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="749" y="1724.8438"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="749" y="2454.9063"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="749" y="2611.5703"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="749" y="2884.7656"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="116.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="987" y="1505.6484"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2937.5391" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1174" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2936.5391" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1573" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2936.5391" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1880" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2936.5391" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2187" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2922.5391" style="stroke: #000000; stroke-width: 2.0;" width="2430" x="22" y="170.0234"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="105.3359" style="stroke: #000000; stroke-width: 2.0;" width="1307.5" x="1134.5" y="1844.5078"/><rect fill="#FFFFFF" height="43.9375" style="stroke: none; stroke-width: 1.0;" width="1307.5" x="1134.5" y="1905.9063"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="90.2031" style="stroke: #000000; stroke-width: 2.0;" width="566.5" x="1540" y="2078.375"/><rect fill="#FFFFFF" height="43.9375" style="stroke: none; stroke-width: 1.0;" width="566.5" x="1540" y="2124.6406"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="131.6641" style="stroke: #000000; stroke-width: 2.0;" width="2410" x="32" y="2655.7031"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="131.6641" style="stroke: #000000; stroke-width: 2.0;" width="2354" x="88" y="2928.8984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="65" x2="65" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="121" x2="121" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="340.5" x2="340.5" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="582" x2="582" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="754" x2="754" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="877" x2="877" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="992" x2="992" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1178.5" x2="1178.5" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1420.5" x2="1420.5" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1578" x2="1578" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1728" x2="1728" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1885" x2="1885" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2034.5" x2="2034.5" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2191.5" x2="2191.5" y1="153.0234" y2="3109.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2385" x2="2385" y1="153.0234" y2="3109.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="42" y="133.4248">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="44.5" y="149.7217">Payer</text><ellipse cx="65" cy="63.4297" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M65,71.4297 L65,98.4297 M52,79.4297 L78,79.4297 M65,98.4297 L52,113.4297 M65,98.4297 L78,113.4297 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="42" y="3121.5576">DFSP1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="44.5" y="3137.8545">Payer</text><ellipse cx="65" cy="3151.1563" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M65,3159.1563 L65,3186.1563 M52,3167.1563 L78,3167.1563 M65,3186.1563 L52,3201.1563 M65,3186.1563 L78,3201.1563 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="98" y="133.4248">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="99" y="149.7217">Payee</text><ellipse cx="121" cy="63.4297" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M121,71.4297 L121,98.4297 M108,79.4297 L134,79.4297 M121,98.4297 L108,113.4297 M121,98.4297 L134,113.4297 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="98" y="3121.5576">DFSP2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="99" y="3137.8545">Payee</text><ellipse cx="121" cy="3151.1563" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M121,3159.1563 L121,3186.1563 M108,3167.1563 L134,3167.1563 M121,3186.1563 L108,3201.1563 M121,3186.1563 L134,3201.1563 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="288.5" y="149.7217">ML API Adapter</text><path d="M320.5,108.7266 L320.5,132.7266 M320.5,120.7266 L337.5,120.7266 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="349.5" cy="120.7266" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="288.5" y="3121.5576">ML API Adapter</text><path d="M320.5,3128.8594 L320.5,3152.8594 M320.5,3140.8594 L337.5,3140.8594 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="349.5" cy="3140.8594" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="554.5" y="133.4248">ML API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="515" y="149.7217">Notification Handler</text><ellipse cx="582" cy="104.4297" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="578,92.4297,584,87.4297,582,92.4297,584,97.4297,578,92.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="554.5" y="3121.5576">ML API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="515" y="3137.8545">Notification Handler</text><ellipse cx="582" cy="3157.1563" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="578,3145.1563,584,3140.1563,582,3145.1563,584,3150.1563,578,3145.1563" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="708" y="97.4297"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="704" y="101.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="725.5" y="121.4248">mongo-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="711" y="137.7217">object-store</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="708" y="3108.5625"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="704" y="3112.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="725.5" y="3132.5576">mongo-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="711" y="3148.8545">object-store</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="814" y="149.7217">Central Service API</text><path d="M857,108.7266 L857,132.7266 M857,120.7266 L874,120.7266 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="886" cy="120.7266" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="814" y="3121.5576">Central Service API</text><path d="M857,3128.8594 L857,3152.8594 M857,3140.8594 L874,3140.8594 " fill="none" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="886" cy="3140.8594" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="955" y="97.4297"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="951" y="101.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="969.5" y="121.4248">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="958" y="137.7217">bulk-fulfil</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="955" y="3108.5625"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="951" y="3112.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="969.5" y="3132.5576">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="958" y="3148.8545">bulk-fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="1144.5" y="133.4248">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="1151" y="149.7217">Handler</text><ellipse cx="1179" cy="104.4297" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1175,92.4297,1181,87.4297,1179,92.4297,1181,97.4297,1175,92.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="1144.5" y="3121.5576">Bulk Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="1151" y="3137.8545">Handler</text><ellipse cx="1179" cy="3157.1563" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1175,3145.1563,1181,3140.1563,1179,3145.1563,1181,3150.1563,1175,3145.1563" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="1395.5" y="97.4297"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="1391.5" y="101.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1398.5" y="121.4248">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="1403" y="137.7217">fulfil</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="1395.5" y="3108.5625"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="1391.5" y="3112.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1398.5" y="3132.5576">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="1403" y="3148.8545">fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="1557.5" y="133.4248">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="1550" y="149.7217">Handler</text><ellipse cx="1578" cy="104.4297" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1574,92.4297,1580,87.4297,1578,92.4297,1580,97.4297,1574,92.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="1557.5" y="3121.5576">Fulfil</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="1550" y="3137.8545">Handler</text><ellipse cx="1578" cy="3157.1563" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1574,3145.1563,1580,3140.1563,1578,3145.1563,1580,3150.1563,1574,3145.1563" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="120" x="1668" y="97.4297"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="120" x="1664" y="101.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1705.5" y="121.4248">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="1671" y="137.7217">transfer-position</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="120" x="1668" y="3108.5625"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="120" x="1664" y="3112.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="1705.5" y="3132.5576">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="1671" y="3148.8545">transfer-position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="1854" y="133.4248">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="1857" y="149.7217">Handler</text><ellipse cx="1885" cy="104.4297" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1881,92.4297,1887,87.4297,1885,92.4297,1887,97.4297,1881,92.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="1854" y="3121.5576">Position</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="1857" y="3137.8545">Handler</text><ellipse cx="1885" cy="3157.1563" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1881,3145.1563,1887,3140.1563,1885,3145.1563,1887,3150.1563,1881,3145.1563" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="1977.5" y="97.4297"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="1973.5" y="101.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="2012.5" y="121.4248">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="1980.5" y="137.7217">bulk-processing</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="1977.5" y="3108.5625"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="1973.5" y="3112.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="2012.5" y="3132.5576">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="1980.5" y="3148.8545">bulk-processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="2138.5" y="133.4248">Bulk Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="2164" y="149.7217">Handler</text><ellipse cx="2192" cy="104.4297" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2188,92.4297,2194,87.4297,2192,92.4297,2194,97.4297,2188,92.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="2138.5" y="3121.5576">Bulk Processing</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="2164" y="3137.8545">Handler</text><ellipse cx="2192" cy="3157.1563" fill="#FEFECE" filter="url(#f14be8qru47z29)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2188,3145.1563,2194,3140.1563,2192,3145.1563,2194,3150.1563,2188,3145.1563" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="2342" y="97.4297"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="2338" y="101.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="2362.5" y="121.4248">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="2345" y="137.7217">notification</text><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="2342" y="3108.5625"/><rect fill="#FEFECE" filter="url(#f14be8qru47z29)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="2338" y="3112.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="2362.5" y="3132.5576">topic-</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="2345" y="3148.8545">notification</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="768.4453" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="336" y="883"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2936.5391" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="577" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="749" y="984.5313"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="44.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="749" y="1724.8438"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="749" y="2454.9063"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="749" y="2611.5703"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="749" y="2884.7656"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="116.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="987" y="1505.6484"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2937.5391" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1174" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2936.5391" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1573" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2936.5391" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1880" y="163.0234"/><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="2936.5391" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2187" y="163.0234"/><path d="M22,170.0234 L440,170.0234 L440,177.0234 L430,187.0234 L22,187.0234 L22,170.0234 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="2922.5391" style="stroke: #000000; stroke-width: 2.0;" width="2430" x="22" y="170.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="373" x="37" y="183.0903">DFSP2 sends a Bulk Fulfil Success Transfer request to DFSP1</text><path d="M126,192.1563 L126,852.1563 L445,852.1563 L445,202.1563 L435,192.1563 L126,192.1563 " fill="#FFFF00" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M435,192.1563 L435,202.1563 L445,202.1563 L435,192.1563 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="132" y="209.2231">Headers - transferHeaders: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="144" y="224.356">Content-Length: &lt;Content-Length&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="144" y="239.4888">Content-Type: &lt;Content-Type&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="144" y="254.6216">Date: &lt;Date&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="144" y="269.7544">X-Forwarded-For: &lt;X-Forwarded-For&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="144" y="284.8872">FSPIOP-Source: &lt;FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="144" y="300.02">FSPIOP-Destination: &lt;FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="144" y="315.1528">FSPIOP-Encryption: &lt;FSPIOP-Encryption&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="144" y="330.2856">FSPIOP-Signature: &lt;FSPIOP-Signature&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="144" y="345.4185">FSPIOP-URI: &lt;FSPIOP-URI&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="144" y="360.5513">FSPIOP-HTTP-Method: &lt;FSPIOP-HTTP-Method&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="132" y="375.6841">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="135" y="390.8169"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="132" y="405.9497">Payload - bulkTransferMessage:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="132" y="421.0825">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="144" y="436.2153">“completedTimestamp": &lt;completedTimeStamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="144" y="451.3481">“bulkTransferState”: &lt;bulkTransferState&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="144" y="466.481">“individualTransferResults”:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="144" y="481.6138">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="156" y="496.7466">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="168" y="511.8794">"transferId": &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="168" y="527.0122">“fulfilment”: &lt;ilpCondition&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="168" y="542.145">"extensionList":</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="168" y="557.2778">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="180" y="572.4106">"extension":</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="180" y="587.5435">[</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="192" y="602.6763">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="204" y="617.8091">“key”: &lt;key&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="204" y="632.9419">“value”: &lt;value&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="192" y="648.0747">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="180" y="663.2075">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="168" y="678.3403">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="156" y="693.4731">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="7" x="144" y="708.606">],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="144" y="723.7388">"extensionList": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="156" y="738.8716">"extension": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="168" y="754.0044">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="180" y="769.1372">“key”: &lt;key&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="180" y="784.27">“value”: &lt;value&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="168" y="799.4028">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="156" y="814.5356">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="144" y="829.6685">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="132" y="844.8013">}</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="334" x2="324" y1="883" y2="879"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="334" x2="324" y1="883" y2="887"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="335" y1="883" y2="883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="128" y="877.9341">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="139" y="877.9341">PUT - /bulkTransfers/&lt;ID&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="388" y1="927.2656" y2="927.2656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="388" x2="388" y1="927.2656" y2="940.2656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="347" x2="388" y1="940.2656" y2="940.2656"/><polygon fill="#A80036" points="357,936.2656,347,940.2656,357,944.2656,353,940.2656" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="353" y="914.6333">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="364" y="907.0669">Validate incoming message</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="364" y="922.1997">Error codes:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="444" y="922.1997">3000-3002, 3100-3107</text><polygon fill="#A80036" points="737,980.5313,747,984.5313,737,988.5313,741,984.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="743" y1="984.5313" y2="984.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="353" y="971.8989">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="364" y="964.3325">Persist incoming bulk message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="364" y="979.4653">to object store</text><polygon fill="#A80036" points="357,1009.6641,347,1013.6641,357,1017.6641,353,1013.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="351" x2="753" y1="1013.6641" y2="1013.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="363" y="1008.5981">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="374" y="1008.5981">Return reference to the stored object</text><path d="M351,1026.6641 L351,1459.6641 L796,1459.6641 L796,1036.6641 L786,1026.6641 L351,1026.6641 " fill="#FFFF00" filter="url(#f14be8qru47z29)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M786,1026.6641 L786,1036.6641 L796,1036.6641 L786,1026.6641 " fill="#FFFF00" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="357" y="1043.731">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="357" y="1058.8638">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="369" y="1073.9966">id: &lt;ID&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="369" y="1089.1294">from: &lt;transferHeaders.FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="246" x="369" y="1104.2622">to: &lt;transferHeaders.FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="369" y="1119.395">type: application/json,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="369" y="1134.5278">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="381" y="1149.6606">headers: &lt;bulkTransferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="381" y="1164.7935">payload: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="393" y="1179.9263">objstore: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="417" y="1195.0591">transactionid: &lt;bulkTransferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="364" x="417" y="1210.1919">referenceid: &lt;bulkTransferMessage_ObjectStoreReference_ID&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="393" y="1225.3247">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="381" y="1240.4575">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="369" y="1255.5903">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="369" y="1270.7231">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="381" y="1285.856">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="393" y="1300.9888">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="393" y="1316.1216">type: bulk-fulfil,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="393" y="1331.2544">action: bulk-commit,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="393" y="1346.3872">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="393" y="1361.52">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="405" y="1376.6528">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="405" y="1391.7856">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="393" y="1406.9185">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="381" y="1422.0513">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="369" y="1437.1841">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="357" y="1452.3169">}</text><polygon fill="#A80036" points="975,1501.6484,985,1505.6484,975,1509.6484,979,1505.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="981" y1="1505.6484" y2="1505.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="353" y="1493.0161">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="364" y="1485.4497">Route &amp; Publish Bulk Fulfil event for Payee</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="364" y="1500.5825">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="438" y="1500.5825">2003</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="997" x2="1039" y1="1565.0469" y2="1565.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1039" x2="1039" y1="1565.0469" y2="1578.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="998" x2="1039" y1="1578.0469" y2="1578.0469"/><polygon fill="#A80036" points="1008,1574.0469,998,1578.0469,1008,1582.0469,1004,1578.0469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="1004" y="1544.8481">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="1015" y="1529.7153">Ensure event is replicated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="1015" y="1544.8481">as configured (ACKS=all)</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="71" x="1015" y="1559.981">Error code:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="1089" y="1559.981">2003</text><polygon fill="#A80036" points="357,1618.3125,347,1622.3125,357,1626.3125,353,1622.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="351" x2="991" y1="1622.3125" y2="1622.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="363" y="1609.6802">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="374" y="1602.1138">Respond replication acknowledgements</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="374" y="1617.2466">have been received</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="131" y1="1651.4453" y2="1647.4453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="121" x2="131" y1="1651.4453" y2="1655.4453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="121" x2="340" y1="1651.4453" y2="1651.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="138" y="1646.3794">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="149" y="1646.3794">Respond HTTP - 200 (OK)</text><polygon fill="#A80036" points="1003,1676.5781,993,1680.5781,1003,1684.5781,999,1680.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="997" x2="1173" y1="1680.5781" y2="1680.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="1009" y="1675.5122">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1020" y="1675.5122">Consume message</text><polygon fill="#A80036" points="770,1720.8438,760,1724.8438,770,1728.8438,766,1724.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="764" x2="1173" y1="1724.8438" y2="1724.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="776" y="1712.2114">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="794" y="1704.645">Retrieve bulk payload using reference</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="794" y="1719.7778">by streaming individual transfers</text><polygon fill="#A80036" points="1162,1765.1094,1172,1769.1094,1162,1773.1094,1166,1769.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="754" x2="1168" y1="1769.1094" y2="1769.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="761" y="1756.4771">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="779" y="1748.9106">Return individual transfers</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="779" y="1764.0435">part of the payload</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="501.5" x="948" y="1777.1094"/><polygon fill="#EEEEEE" points="948,1777.1094,1012,1777.1094,1012,1784.1094,1002,1794.1094,948,1794.1094,948,1777.1094" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="961" y="1791.1763">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="1118.75" y="1810.1763">Bulk Fulfil Handler Consume</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1121.75" y="1825.3091"/><path d="M1134.5,1844.5078 L1197.5,1844.5078 L1197.5,1851.5078 L1187.5,1861.5078 L1134.5,1861.5078 L1134.5,1844.5078 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="105.3359" style="stroke: #000000; stroke-width: 2.0;" width="1307.5" x="1134.5" y="1844.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1149.5" y="1857.5747">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="49" x="1212.5" y="1856.7183">[Success]</text><polygon fill="#A80036" points="1409,1893.9063,1419,1897.9063,1409,1901.9063,1413,1897.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1184" x2="1415" y1="1897.9063" y2="1897.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1191" y="1885.2739">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="1209" y="1877.7075">Produce single transfer message</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="1209" y="1892.8403">for each individual transfer [loop]</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1134.5" x2="2442" y1="1906.9063" y2="1906.9063"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="1139.5" y="1917.1167">[Failure]</text><polygon fill="#A80036" points="2373,1937.8438,2383,1941.8438,2373,1945.8438,2377,1941.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1184" x2="2379" y1="1941.8438" y2="1941.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1191" y="1936.7778">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="1209" y="1936.7778">Produce message for the bulk transfer</text><polygon fill="#A80036" points="1432,1998.9766,1422,2002.9766,1432,2006.9766,1428,2002.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1426" x2="1572" y1="2002.9766" y2="2002.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1438" y="1997.9106">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1456" y="1997.9106">Consume message</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="402.5" x="1388.5" y="2010.9766"/><polygon fill="#EEEEEE" points="1388.5,2010.9766,1452.5,2010.9766,1452.5,2017.9766,1442.5,2027.9766,1388.5,2027.9766,1388.5,2010.9766" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1401.5" y="2025.0435">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="1495.25" y="2044.0435">Fulfil Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1498.25" y="2059.1763"/><path d="M1540,2078.375 L1603,2078.375 L1603,2085.375 L1593,2095.375 L1540,2095.375 L1540,2078.375 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.2031" style="stroke: #000000; stroke-width: 2.0;" width="566.5" x="1540" y="2078.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1555" y="2091.4419">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="49" x="1618" y="2090.5854">[Success]</text><polygon fill="#A80036" points="1716,2112.6406,1726,2116.6406,1716,2120.6406,1720,2116.6406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1583" x2="1722" y1="2116.6406" y2="2116.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1590" y="2111.5747">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1608" y="2111.5747">Produce message</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1540" x2="2106.5" y1="2125.6406" y2="2125.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="1545" y="2135.8511">[Failure]</text><polygon fill="#A80036" points="2023,2156.5781,2033,2160.5781,2023,2164.5781,2027,2160.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1583" x2="2029" y1="2160.5781" y2="2160.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1590" y="2155.5122">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1608" y="2155.5122">Produce message</text><polygon fill="#A80036" points="1739,2217.7109,1729,2221.7109,1739,2225.7109,1735,2221.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1733" x2="1879" y1="2221.7109" y2="2221.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1745" y="2216.645">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1763" y="2216.645">Consume message</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="434.5" x="1661" y="2229.7109"/><polygon fill="#EEEEEE" points="1661,2229.7109,1725,2229.7109,1725,2236.7109,1715,2246.7109,1661,2246.7109,1661,2229.7109" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1674" y="2243.7778">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="1773.75" y="2262.7778">Position Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1776.75" y="2277.9106"/><polygon fill="#A80036" points="2023,2307.2422,2033,2311.2422,2023,2315.2422,2027,2311.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1890" x2="2029" y1="2311.2422" y2="2311.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="1897" y="2306.1763">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="1915" y="2306.1763">Produce message</text><polygon fill="#A80036" points="2046,2361.375,2036,2365.375,2046,2369.375,2042,2365.375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2040" x2="2186" y1="2365.375" y2="2365.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="2052" y="2360.3091">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="2070" y="2360.3091">Consume message</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="460.5" x="1970.5" y="2373.375"/><polygon fill="#EEEEEE" points="1970.5,2373.375,2034.5,2373.375,2034.5,2380.375,2024.5,2390.375,1970.5,2390.375,1970.5,2373.375" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1983.5" y="2387.4419">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="257" x="2074.25" y="2406.4419">Bulk Processing Handler Consume (Success)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="2077.25" y="2421.5747"/><polygon fill="#A80036" points="770,2450.9063,760,2454.9063,770,2458.9063,766,2454.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="764" x2="2186" y1="2454.9063" y2="2454.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="776" y="2449.8403">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="794" y="2449.8403">Persist bulk message to object store</text><polygon fill="#A80036" points="2175,2480.0391,2185,2484.0391,2175,2488.0391,2179,2484.0391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="754" x2="2181" y1="2484.0391" y2="2484.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="761" y="2478.9731">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="779" y="2478.9731">Return reference to the stored object</text><polygon fill="#A80036" points="2373,2509.1719,2383,2513.1719,2373,2517.1719,2377,2513.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2197" x2="2379" y1="2513.1719" y2="2513.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="2204" y="2508.106">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="2222" y="2508.106">Produce bulk notification</text><polygon fill="#A80036" points="2373,2563.3047,2383,2567.3047,2373,2571.3047,2377,2567.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="587" x2="2379" y1="2567.3047" y2="2567.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="594" y="2562.2388">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="612" y="2562.2388">Consume message</text><polygon fill="#A80036" points="737,2607.5703,747,2611.5703,737,2615.5703,741,2611.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="587" x2="743" y1="2611.5703" y2="2611.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="594" y="2598.938">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="612" y="2591.3716">Retrieve bulk payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="612" y="2606.5044">using reference</text><polygon fill="#A80036" points="598,2636.7031,588,2640.7031,598,2644.7031,594,2640.7031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="592" x2="753" y1="2640.7031" y2="2640.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="604" y="2635.6372">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="622" y="2635.6372">Return payload</text><path d="M32,2655.7031 L99,2655.7031 L99,2662.7031 L89,2672.7031 L32,2672.7031 L32,2655.7031 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="131.6641" style="stroke: #000000; stroke-width: 2.0;" width="2410" x="32" y="2655.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="47" y="2668.77">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="114" y="2667.9136">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="2392" x="39" y="2697.8359"/><polygon fill="#EEEEEE" points="39,2697.8359,103,2697.8359,103,2704.8359,93,2714.8359,39,2714.8359,39,2697.8359" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="52" y="2711.9028">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="222" x="1126" y="2730.9028">Send notification to Participant (Payer)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1129" y="2746.0356"/><polygon fill="#A80036" points="76,2775.3672,66,2779.3672,76,2783.3672,72,2779.3672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="70" x2="576" y1="2779.3672" y2="2779.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="82" y="2774.3013">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="100" y="2774.3013">Send callback notification</text><polygon fill="#A80036" points="2373,2836.5,2383,2840.5,2373,2844.5,2377,2840.5" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="587" x2="2379" y1="2840.5" y2="2840.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="594" y="2835.4341">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="612" y="2835.4341">Consume message</text><polygon fill="#A80036" points="737,2880.7656,747,2884.7656,737,2888.7656,741,2884.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="587" x2="743" y1="2884.7656" y2="2884.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="594" y="2872.1333">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="612" y="2864.5669">Retrieve bulk payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="612" y="2879.6997">using reference</text><polygon fill="#A80036" points="598,2909.8984,588,2913.8984,598,2917.8984,594,2913.8984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="592" x2="753" y1="2913.8984" y2="2913.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="604" y="2908.8325">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="622" y="2908.8325">Return payload</text><path d="M88,2928.8984 L155,2928.8984 L155,2935.8984 L145,2945.8984 L88,2945.8984 L88,2928.8984 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="131.6641" style="stroke: #000000; stroke-width: 2.0;" width="2354" x="88" y="2928.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="22" x="103" y="2941.9653">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="170" y="2941.1089">[action == 'commit']</text><rect fill="#FFFFFF" filter="url(#f14be8qru47z29)" height="55.3984" style="stroke: #000000; stroke-width: 2.0;" width="2336" x="95" y="2971.0313"/><polygon fill="#EEEEEE" points="95,2971.0313,159,2971.0313,159,2978.0313,149,2988.0313,95,2988.0313,95,2971.0313" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="108" y="2985.0981">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="1153" y="3004.0981">Send notification to Participant (Payee)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1156" y="3019.231"/><polygon fill="#A80036" points="132,3048.5625,122,3052.5625,132,3056.5625,128,3052.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126" x2="576" y1="3052.5625" y2="3052.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="138" y="3047.4966">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="156" y="3047.4966">Send callback notification</text><!--
@startuml
title 2.1.0. DFSP2 sends a Bulk Fulfil Success Transfer request

autonumber


actor "DFSP1\nPayer" as DFSP1
actor "DFSP2\nPayee" as DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API \nNotification Handler" as NOTIFY_HANDLER
collections "mongo-\nobject-store" as OBJECT_STORE
boundary "Central Service API" as CSAPI
collections "topic-\nbulk-fulfil" as TOPIC_BULK_FULFIL
control "Bulk Fulfil\nHandler" as BULK_FULFIL_HANDLER
collections "topic-\nfulfil" as TOPIC_FULFIL
control "Fulfil \nHandler" as FULF_HANDLER
collections "topic-\ntransfer-position" as TOPIC_TRANSFER_POSITION
control "Position \nHandler" as POS_HANDLER
collections "topic-\nbulk-processing" as TOPIC_BULK_PROCESSING
control "Bulk Processing\nHandler" as BULK_PROC_HANDLER
collections "topic-\nnotification" as TOPIC_NOTIFICATIONS

box "Financial Service Providers" #lightGray
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightBlue
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant OBJECT_STORE
    participant CSAPI
    participant TOPIC_BULK_FULFIL
    participant BULK_FULFIL_HANDLER
	participant TOPIC_FULFIL
    participant FULF_HANDLER
    participant TOPIC_TRANSFER_POSITION
    participant POS_HANDLER
    participant TOPIC_BULK_PROCESSING
    participant BULK_PROC_HANDLER
    participant TOPIC_NOTIFICATIONS
end box

activate NOTIFY_HANDLER
activate BULK_FULFIL_HANDLER
activate FULF_HANDLER
activate POS_HANDLER
activate BULK_PROC_HANDLER
group DFSP2 sends a Bulk Fulfil Success Transfer request to DFSP1
    note right of DFSP2 #yellow
        Headers - transferHeaders: {
            Content-Length: <Content-Length>,
            Content-Type: <Content-Type>,
            Date: <Date>,
            X-Forwarded-For: <X-Forwarded-For>,
            FSPIOP-Source: <FSPIOP-Source>,
            FSPIOP-Destination: <FSPIOP-Destination>,
            FSPIOP-Encryption: <FSPIOP-Encryption>,
            FSPIOP-Signature: <FSPIOP-Signature>,
            FSPIOP-URI: <FSPIOP-URI>,
            FSPIOP-HTTP-Method: <FSPIOP-HTTP-Method>
        }

        Payload - bulkTransferMessage:
        {
            “completedTimestamp": <completedTimeStamp>,
            “bulkTransferState”: <bulkTransferState>,
            “individualTransferResults”: 
            [
                {
                    "transferId": <uuid>, 
                    “fulfilment”: <ilpCondition>,
                    "extensionList":
                    {
                        "extension":
                        [ 
                            { 
                                “key”: <key>, 
                                “value”: <value> 
                            }
                        ]
                    }
                }
            ],
            "extensionList": {
                "extension": [
                    {
                        “key”: <key>, 
                        “value”: <value> 
                    }
                ]
            }
        }
    end note
    DFSP2 ->> MLAPI: PUT - /bulkTransfers/<ID>
    activate MLAPI
    MLAPI -> MLAPI: Validate incoming message\n<color #FF0000><b>Error codes:</b> 3000-3002, 3100-3107</color>
    MLAPI -> OBJECT_STORE: Persist incoming bulk message\nto object store
    activate OBJECT_STORE
    OBJECT_STORE - -> MLAPI: Return reference to the stored object
    deactivate OBJECT_STORE
    note right of MLAPI #yellow
        Message:
        {
            id: <ID>,
            from: <transferHeaders.FSPIOP-Source>,
            to: <transferHeaders.FSPIOP-Destination>,
            type: application/json,
            content: {
                headers: <bulkTransferHeaders>,
                payload: {
                    objstore: {
                            transactionid: <bulkTransferId>
                            referenceid: <bulkTransferMessage_ObjectStoreReference_ID>
                    }
                }
            },
            metadata: {
                event: {
                    id: <uuid>,
                    type: bulk-fulfil,
                    action: bulk-commit,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    MLAPI -> TOPIC_BULK_FULFIL: Route & Publish Bulk Fulfil event for Payee\n<color #FF0000><b>Error code:</b> 2003</color>
    activate TOPIC_BULK_FULFIL
    TOPIC_BULK_FULFIL <-> TOPIC_BULK_FULFIL: Ensure event is replicated \nas configured (ACKS=all)\n<color #FF0000><b>Error code:</b> 2003</color>
    TOPIC_BULK_FULFIL - -> MLAPI: Respond replication acknowledgements \nhave been received
    deactivate TOPIC_BULK_FULFIL
    MLAPI - ->> DFSP2: Respond HTTP - 200 (OK)
    deactivate MLAPI
    TOPIC_BULK_FULFIL <- BULK_FULFIL_HANDLER: Consume message
    BULK_FULFIL_HANDLER -> OBJECT_STORE: Retrieve bulk payload using reference\nby streaming individual transfers
    activate OBJECT_STORE
    OBJECT_STORE - -> BULK_FULFIL_HANDLER: Return individual transfers\npart of the payload
    deactivate OBJECT_STORE
    ref over TOPIC_BULK_FULFIL, TOPIC_FULFIL: Bulk Fulfil Handler Consume\n
    alt Success
        BULK_FULFIL_HANDLER -> TOPIC_FULFIL: Produce single transfer message\nfor each individual transfer [loop]
    else Failure
        BULK_FULFIL_HANDLER - -> TOPIC_NOTIFICATIONS: Produce message for the bulk transfer
    end
    |||
    TOPIC_FULFIL <- FULF_HANDLER: Consume message
    ref over TOPIC_FULFIL, TOPIC_TRANSFER_POSITION: Fulfil Handler Consume (Success)\n
    alt Success
        FULF_HANDLER -> TOPIC_TRANSFER_POSITION: Produce message
    else Failure
        FULF_HANDLER - -> TOPIC_BULK_PROCESSING: Produce message
    end
    |||
    TOPIC_TRANSFER_POSITION <- POS_HANDLER: Consume message
    ref over TOPIC_TRANSFER_POSITION, TOPIC_BULK_PROCESSING: Position Handler Consume (Success)\n
    POS_HANDLER -> TOPIC_BULK_PROCESSING: Produce message
    |||
    TOPIC_BULK_PROCESSING <- BULK_PROC_HANDLER: Consume message
    ref over TOPIC_BULK_PROCESSING, TOPIC_NOTIFICATIONS: Bulk Processing Handler Consume (Success)\n
    BULK_PROC_HANDLER -> OBJECT_STORE: Persist bulk message to object store
    activate OBJECT_STORE
    OBJECT_STORE - -> BULK_PROC_HANDLER: Return reference to the stored object
    deactivate OBJECT_STORE
    BULK_PROC_HANDLER -> TOPIC_NOTIFICATIONS: Produce bulk notification
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    NOTIFY_HANDLER -> OBJECT_STORE: Retrieve bulk payload\nusing reference
    activate OBJECT_STORE
    OBJECT_STORE - -> NOTIFY_HANDLER: Return payload
    deactivate OBJECT_STORE
    opt action == 'commit'
        |||
        ref over DFSP1, TOPIC_NOTIFICATIONS: Send notification to Participant (Payer)\n
        NOTIFY_HANDLER -> DFSP1: Send callback notification
    end
    |||
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: Consume message
    NOTIFY_HANDLER -> OBJECT_STORE: Retrieve bulk payload\nusing reference
    activate OBJECT_STORE
    OBJECT_STORE - -> NOTIFY_HANDLER: Return payload
    deactivate OBJECT_STORE
    opt action == 'commit'
        |||
        ref over DFSP2, TOPIC_NOTIFICATIONS: Send notification to Participant (Payee)\n
        NOTIFY_HANDLER -> DFSP2: Send callback notification
    end
    |||
end
deactivate POS_HANDLER
activate BULK_FULFIL_HANDLER
deactivate FULF_HANDLER
deactivate BULK_PROC_HANDLER
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2018.02(Fri Mar 09 17:20:44 GMT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-b04
Operating System: Linux
OS Version: 4.15.0-1035-aws
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>