<?xml version="1.0" encoding="us-ascii" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1320px" preserveAspectRatio="none" style="width:831px;height:1320px;background:#FFFFFF;" version="1.1" viewBox="0 0 831 1320" width="831px" zoomAndPan="magnify">
  <defs/>
  <g>
    <text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="340" x="247.25" y="27.9951">1.3.4.4. Position Timeout Reserved Domain</text>
    <rect fill="#FFFFFF" height="1160.4375" style="stroke:#181818;stroke-width:1.0;" width="10" x="149.5" y="100.5938"/>
    <rect fill="none" height="1113.3047" style="stroke:#000000;stroke-width:1.5;" width="815.5" x="10" y="140.7266"/>
    <rect fill="none" height="889.1094" style="stroke:#000000;stroke-width:1.5;" width="795.5" x="20" y="206.9922"/>
    <line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="154" x2="154" y1="90.5938" y2="1271.0313"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="30" y="87.292">Position Timeout Reserved Domain</text>
    <ellipse cx="154.5" cy="58.2969" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <polygon fill="#181818" points="150.5,46.2969,156.5,41.2969,154.5,46.2969,156.5,51.2969,150.5,46.2969" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="243" x="30" y="1283.0264">Position Timeout Reserved Domain</text>
    <ellipse cx="154.5" cy="1302.3281" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/>
    <polygon fill="#181818" points="150.5,1290.3281,156.5,1285.3281,154.5,1290.3281,156.5,1295.3281,150.5,1290.3281" style="stroke:#181818;stroke-width:1.0;"/>
    <rect fill="#FFFFFF" height="1160.4375" style="stroke:#181818;stroke-width:1.0;" width="10" x="149.5" y="100.5938"/>
    <rect fill="#ADD8E6" height="23" style="stroke:#181818;stroke-width:0.5;" width="363" x="164" y="105.5938"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355" x="168" y="121.6606">INPUT: bin, accumulatedPosition, transferStateChanges</text>
    <path d="M10,140.7266 L385,140.7266 L385,147.8594 L375,157.8594 L10,157.8594 L10,140.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="1113.3047" style="stroke:#000000;stroke-width:1.5;" width="815.5" x="10" y="140.7266"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="330" x="25" y="153.7935">Timeout Reserved Position Batch Processing</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="201.5" y1="178.9922" y2="178.9922"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="201.5" x2="201.5" y1="178.9922" y2="191.9922"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="160.5" x2="201.5" y1="191.9922" y2="191.9922"/>
    <polygon fill="#181818" points="170.5,187.9922,160.5,191.9922,170.5,195.9922,166.5,191.9922" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="166.5" y="173.9263">1</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="179.5" y="173.9263">runningPosition</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="298.5" y="173.9263">= accumulatedPosition</text>
    <path d="M20,206.9922 L97,206.9922 L97,214.125 L87,224.125 L20,224.125 L20,206.9922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="none" height="889.1094" style="stroke:#000000;stroke-width:1.5;" width="795.5" x="20" y="206.9922"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="35" y="220.0591">loop</text>
    <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="189" x="112" y="219.2026">[for each message in the bin]</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="201.5" y1="260.3906" y2="260.3906"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="201.5" x2="201.5" y1="260.3906" y2="273.3906"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="160.5" x2="201.5" y1="273.3906" y2="273.3906"/>
    <polygon fill="#181818" points="170.5,269.3906,160.5,273.3906,170.5,277.3906,166.5,273.3906" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="166.5" y="247.7583">2</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="624" x="179.5" y="240.1919">Validate current state of transfer (transferStateChange.transferStateId == &apos;RESERVED_TIMEOUT&apos;)</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82" x="179.5" y="255.3247">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="265.5" y="255.3247">2001</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="201.5" y1="302.5234" y2="302.5234"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="201.5" x2="201.5" y1="302.5234" y2="315.5234"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="160.5" x2="201.5" y1="315.5234" y2="315.5234"/>
    <polygon fill="#181818" points="170.5,311.5234,160.5,315.5234,170.5,319.5234,166.5,315.5234" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="166.5" y="297.4575">3</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="179.5" y="297.4575">runningPosition</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284" x="298.5" y="297.4575">= runningPosition - payload.amount.amount</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="201.5" y1="344.6563" y2="344.6563"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="201.5" x2="201.5" y1="344.6563" y2="357.6563"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="160.5" x2="201.5" y1="357.6563" y2="357.6563"/>
    <polygon fill="#181818" points="170.5,353.6563,160.5,357.6563,170.5,361.6563,166.5,357.6563" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="166.5" y="339.5903">4</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341" x="179.5" y="339.5903">transferStateChange should be populated and add to</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="524.5" y="339.5903">transferStateChanges</text>
    <polygon fill="#FFFFE0" points="174,370.6563,448,370.6563,458,396.6563,448,423.6563,174,423.6563,164,396.6563,174,370.6563" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="176" y="386.7231">transferStateChange</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="330" y="386.7231">: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="176" y="401.856">    </text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="192" y="401.856">transferStateId</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="304" y="401.856">: &apos;EXPIRED_RESERVED&apos;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="176" y="416.9888">}</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="201.5" y1="450.1875" y2="450.1875"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="201.5" x2="201.5" y1="450.1875" y2="463.1875"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="160.5" x2="201.5" y1="463.1875" y2="463.1875"/>
    <polygon fill="#181818" points="170.5,459.1875,160.5,463.1875,170.5,467.1875,166.5,463.1875" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="166.5" y="445.1216">5</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374" x="179.5" y="445.1216">participantPositionChange should be populated and add to</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="204" x="557.5" y="445.1216">participantPositionChanges</text>
    <polygon fill="#FFFFE0" points="174,476.1875,741,476.1875,751,525.1875,741,574.1875,174,574.1875,164,525.1875,174,476.1875" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196" x="176" y="492.2544">participantPositionChange</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="372" y="492.2544">: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="520" x="192" y="507.3872">transferStateChangeId: We need this, may be need to update in the handler (???)</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="192" y="522.52">value = runningPosition,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="360" x="192" y="537.6528">reservedValue = participantPosition.reservedValue (???)</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="547" x="192" y="552.7856">createdDate = new Date() (Get time here or while executing the query in handler ???)</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="176" y="567.9185">}</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="201.5" y1="601.1172" y2="601.1172"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="201.5" x2="201.5" y1="601.1172" y2="614.1172"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="160.5" x2="201.5" y1="614.1172" y2="614.1172"/>
    <polygon fill="#181818" points="170.5,610.1172,160.5,614.1172,170.5,618.1172,166.5,614.1172" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="166.5" y="596.0513">6</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300" x="179.5" y="596.0513">resultMessage should be populated and add to</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="116" x="483.5" y="596.0513">resultMessages</text>
    <path d="M164,627.1172 L164,1090.1172 L584,1090.1172 L584,637.1172 L574,627.1172 L164,627.1172 " fill="#FFFF00" style="stroke:#181818;stroke-width:0.5;"/>
    <path d="M574,627.1172 L574,637.1172 L584,637.1172 L574,627.1172 " fill="#FFFF00" style="stroke:#181818;stroke-width:0.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108" x="170" y="644.1841">resultMessage</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="278" y="644.1841">: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="186" y="659.3169">id: &lt;transferMessage.transferId&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="186" y="674.4497">from: &lt;transferMessage.payerFsp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="186" y="689.5825">to: &lt;transferMessage.payeeFsp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="186" y="704.7153">type: application/json</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="186" y="719.8481">content: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="202" y="734.981">headers: &lt;transferHeaders&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="202" y="750.1138">payload: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="234" y="765.2466">&quot;errorInformation&quot;: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="250" y="780.3794">&quot;errorCode&quot;: 3300,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238" x="250" y="795.5122">&quot;errorDescription&quot;: &quot;Transfer expired&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="319" x="250" y="810.645">&quot;extensionList&quot;: &lt;transferMessage.extensionList&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="234" y="825.7778">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="202" y="840.9106">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12" x="186" y="856.0435">},</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="186" y="871.1763">metadata: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="202" y="886.3091">event: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="218" y="901.4419">id: &lt;uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="218" y="916.5747">responseTo: &lt;previous.uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="218" y="931.7075">type: notification,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="218" y="946.8403">action: abort,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="218" y="961.9731">createdAt: &lt;timestamp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="218" y="977.106">state: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="234" y="992.2388">status: &apos;error&apos;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="234" y="1007.3716">code: &lt;errorInformation.errorCode&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311" x="234" y="1022.5044">description: &lt;errorInformation.errorDescription&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="218" y="1037.6372">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="202" y="1052.77">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="186" y="1067.9028">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="170" y="1083.0356">}</text>
    <line style="stroke:#181818;stroke-width:1.0;" x1="159.5" x2="201.5" y1="1124.2344" y2="1124.2344"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="201.5" x2="201.5" y1="1124.2344" y2="1137.2344"/>
    <line style="stroke:#181818;stroke-width:1.0;" x1="160.5" x2="201.5" y1="1137.2344" y2="1137.2344"/>
    <polygon fill="#181818" points="170.5,1133.2344,160.5,1137.2344,170.5,1141.2344,166.5,1137.2344" style="stroke:#181818;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="166.5" y="1119.1685">7</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="179.5" y="1119.1685">Return the following</text>
    <rect fill="#ADD8E6" height="98" style="stroke:#181818;stroke-width:0.5;" width="473" x="164" y="1150.2344"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="168" y="1166.3013">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="168" y="1181.4341">    </text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="184" y="1181.4341">accumulatedPosition</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="338" y="1181.4341">: runningPosition,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="168" y="1196.5669">    </text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="162" x="184" y="1196.5669">transferStateChanges</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="346" y="1196.5669">,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="168" y="1211.6997">    </text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="204" x="184" y="1211.6997">participantPositionChanges</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="388" y="1211.6997">,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="168" y="1226.8325">    </text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="116" x="184" y="1226.8325">resultMessages</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="333" x="300" y="1226.8325">, (The list of messages to be sent to the kafka topic)</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="168" y="1241.9653">}</text>
  </g>
</svg>
