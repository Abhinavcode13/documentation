<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1562px" preserveAspectRatio="none" style="width:939px;height:1562px;" version="1.1" viewBox="0 0 939 1562" width="939px" zoomAndPan="magnify">
  <defs>
    <filter height="300%" id="f1hx991qlnyej3" width="300%" x="-1" y="-1">
      <feGaussianBlur result="blurOut" stdDeviation="2.0"/>
      <feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
      <feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/>
      <feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/>
    </filter>
  </defs>
  <g>
    <text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="286" x="324.5" y="28.708">1.3.2. Position Fulfil Facade v1.1</text>
    <rect fill="#FFFFE0" height="1515.5625" style="stroke:#A80036;stroke-width:1.0;" width="798.5" x="26" y="40.9531"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="369.75" y="53.02">Central Service</text>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="1348.8359" style="stroke:#A80036;stroke-width:1.0;" width="10" x="99.5" y="132.3828"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="77.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="608.5" y="250.0469"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="62.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="608.5" y="453.1094"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="608.5" y="586.6406"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="608.5" y="858.9688"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="741" y="1436.2188"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="1334.8359" style="stroke:#000000;stroke-width:2.0;" width="915" x="10" y="139.3828"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="590.9219" style="stroke:#000000;stroke-width:2.0;" width="895" x="20" y="414.8438"/>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="104" x2="104" y1="122.3828" y2="1491.2188"/>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="613.5" x2="613.5" y1="122.3828" y2="1491.2188"/>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="745.5" x2="745.5" y1="122.3828" y2="1491.2188"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="30" y="119.0811">Position Fulfil Facade</text>
    <ellipse cx="104.5" cy="90.0859" fill="#FEFECE" filter="url(#f1hx991qlnyej3)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/>
    <polygon fill="#A80036" points="100.5,78.0859,106.5,73.0859,104.5,78.0859,106.5,83.0859,100.5,78.0859" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="30" y="1503.2139">Position Fulfil Facade</text>
    <ellipse cx="104.5" cy="1522.5156" fill="#FEFECE" filter="url(#f1hx991qlnyej3)" rx="12" ry="12" style="stroke:#A80036;stroke-width:2.0;"/>
    <polygon fill="#A80036" points="100.5,1510.5156,106.5,1505.5156,104.5,1510.5156,106.5,1515.5156,100.5,1510.5156" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="565.5" y="119.0811">Central Store</text>
    <path d="M595.5,70.0859 C595.5,60.0859 613.5,60.0859 613.5,60.0859 C613.5,60.0859 631.5,60.0859 631.5,70.0859 L631.5,96.0859 C631.5,106.0859 613.5,106.0859 613.5,106.0859 C613.5,106.0859 595.5,106.0859 595.5,96.0859 L595.5,70.0859 " fill="#FEFECE" filter="url(#f1hx991qlnyej3)" style="stroke:#000000;stroke-width:1.5;"/>
    <path d="M595.5,70.0859 C595.5,80.0859 613.5,80.0859 613.5,80.0859 C613.5,80.0859 631.5,80.0859 631.5,70.0859 " fill="none" style="stroke:#000000;stroke-width:1.5;"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="565.5" y="1503.2139">Central Store</text>
    <path d="M595.5,1516.5156 C595.5,1506.5156 613.5,1506.5156 613.5,1506.5156 C613.5,1506.5156 631.5,1506.5156 631.5,1516.5156 L631.5,1542.5156 C631.5,1552.5156 613.5,1552.5156 613.5,1552.5156 C613.5,1552.5156 595.5,1552.5156 595.5,1542.5156 L595.5,1516.5156 " fill="#FEFECE" filter="url(#f1hx991qlnyej3)" style="stroke:#000000;stroke-width:1.5;"/>
    <path d="M595.5,1516.5156 C595.5,1526.5156 613.5,1526.5156 613.5,1526.5156 C613.5,1526.5156 631.5,1526.5156 631.5,1516.5156 " fill="none" style="stroke:#000000;stroke-width:1.5;"/>
    <rect fill="#FEFECE" filter="url(#f1hx991qlnyej3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="141" x="675.5" y="83.0859"/>
    <rect fill="#FEFECE" filter="url(#f1hx991qlnyej3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="141" x="671.5" y="87.0859"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="678.5" y="107.0811">Notifications-Topic</text>
    <rect fill="#FEFECE" filter="url(#f1hx991qlnyej3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="141" x="675.5" y="1490.2188"/>
    <rect fill="#FEFECE" filter="url(#f1hx991qlnyej3)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="141" x="671.5" y="1494.2188"/>
    <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="678.5" y="1514.2139">Notifications-Topic</text>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="1348.8359" style="stroke:#A80036;stroke-width:1.0;" width="10" x="99.5" y="132.3828"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="77.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="608.5" y="250.0469"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="62.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="608.5" y="453.1094"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="608.5" y="586.6406"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="608.5" y="858.9688"/>
    <rect fill="#FFFFFF" filter="url(#f1hx991qlnyej3)" height="30" style="stroke:#A80036;stroke-width:1.0;" width="10" x="741" y="1436.2188"/>
    <path d="M10,139.3828 L288,139.3828 L288,146.3828 L278,156.3828 L10,156.3828 L10,139.3828 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/>
    <rect fill="none" height="1334.8359" style="stroke:#000000;stroke-width:2.0;" width="915" x="10" y="139.3828"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="233" x="25" y="152.4497">Fulfil Position Batch Processing</text>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="151.5" y1="192.7813" y2="192.7813"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="151.5" x2="151.5" y1="192.7813" y2="205.7813"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="110.5" x2="151.5" y1="205.7813" y2="205.7813"/>
    <polygon fill="#A80036" points="120.5,201.7813,110.5,205.7813,120.5,209.7813,116.5,205.7813" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="116.5" y="180.1489">1</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="129.5" y="172.5825">Loop through batch and build list of transferIds</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="430" x="133.5" y="187.7153">and calculate sumTransfersInBatch (from payload.amount.amount)</text>
    <polygon fill="#A80036" points="596.5,246.0469,606.5,250.0469,596.5,254.0469,600.5,250.0469" style="stroke:#A80036;stroke-width:1.0;"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="602.5" y1="250.0469" y2="250.0469"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="116.5" y="237.4146">2</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="467" x="129.5" y="229.8481">Retrieve current state of all transfers in array from DB with select whereIn</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="129.5" y="244.981">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="215.5" y="244.981">2003</text>
    <polygon fill="#FFFFE0" filter="url(#f1hx991qlnyej3)" points="544,263.0469,682,263.0469,692,282.0469,682,301.0469,544,301.0469,534,282.0469,544,263.0469" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="546" y="279.1138">transferStateChange</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="546" y="294.2466">transferParticipant</text>
    <polygon fill="#A80036" points="120.5,323.4453,110.5,327.4453,120.5,331.4453,116.5,327.4453" style="stroke:#A80036;stroke-width:1.0;"/>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="114.5" x2="612.5" y1="327.4453" y2="327.4453"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="126.5" y="322.3794">3</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="139.5" y="322.3794">Return current state of transfer from DB</text>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="151.5" y1="386.8438" y2="386.8438"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="151.5" x2="151.5" y1="386.8438" y2="399.8438"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="110.5" x2="151.5" y1="399.8438" y2="399.8438"/>
    <polygon fill="#A80036" points="120.5,395.8438,110.5,399.8438,120.5,403.8438,116.5,399.8438" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="116.5" y="366.645">4</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="371" x="129.5" y="351.5122">Validate current state (transferState is &apos;RECEIVED-FULFIL&apos;)</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="129.5" y="366.645">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="215.5" y="366.645">2001</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="251.5" y="366.645">against failing transfers</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="129.5" y="381.7778">Batch is not rejected as a whole</text>
    <path d="M20,414.8438 L814,414.8438 L814,421.8438 L804,431.8438 L20,431.8438 L20,414.8438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/>
    <rect fill="none" height="590.9219" style="stroke:#000000;stroke-width:2.0;" width="895" x="20" y="414.8438"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="749" x="35" y="427.9106">Persist Position change and Transfer State (with transferState=&apos;COMMITTED&apos; on position check pass)</text>
    <polygon fill="#A80036" points="596.5,449.1094,606.5,453.1094,596.5,457.1094,600.5,453.1094" style="stroke:#A80036;stroke-width:1.0;"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="602.5" y1="453.1094" y2="453.1094"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="116.5" y="448.0435">5</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="406" x="129.5" y="448.0435">Select participantPosition.value FOR UPDATE from DB for Payee</text>
    <polygon fill="#FFFFE0" filter="url(#f1hx991qlnyej3)" points="552,466.1094,674,466.1094,684,477.1094,674,489.1094,552,489.1094,542,477.1094,552,466.1094" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="554" y="482.1763">participantPosition</text>
    <polygon fill="#A80036" points="120.5,511.375,110.5,515.375,120.5,519.375,116.5,515.375" style="stroke:#A80036;stroke-width:1.0;"/>
    <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="114.5" x2="612.5" y1="515.375" y2="515.375"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="126.5" y="510.3091">6</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="323" x="139.5" y="510.3091">Return participantPosition.value from DB for Payee</text>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="151.5" y1="544.5078" y2="544.5078"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="151.5" x2="151.5" y1="544.5078" y2="557.5078"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="110.5" x2="151.5" y1="557.5078" y2="557.5078"/>
    <polygon fill="#A80036" points="120.5,553.5078,110.5,557.5078,120.5,561.5078,116.5,557.5078" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="116.5" y="539.4419">7</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="129.5" y="539.4419">latestPosition</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="319" x="234.5" y="539.4419">= participantPosition.value - sumTransfersInBatch</text>
    <polygon fill="#A80036" points="596.5,582.6406,606.5,586.6406,596.5,590.6406,600.5,586.6406" style="stroke:#A80036;stroke-width:1.0;"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="602.5" y1="586.6406" y2="586.6406"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="116.5" y="581.5747">8</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="129.5" y="581.5747">Persist latestPosition to DB for Payee</text>
    <polygon fill="#FFFFE0" filter="url(#f1hx991qlnyej3)" points="513,629.6406,713,629.6406,723,648.6406,713,667.6406,513,667.6406,503,648.6406,513,629.6406" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="515" y="645.7075">UPDATE</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="140" x="571" y="645.7075">participantPosition</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="515" y="660.8403">SET value = latestPosition</text>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="151.5" y1="709.1719" y2="709.1719"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="151.5" x2="151.5" y1="709.1719" y2="722.1719"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="110.5" x2="151.5" y1="722.1719" y2="722.1719"/>
    <polygon fill="#A80036" points="120.5,718.1719,110.5,722.1719,120.5,726.1719,116.5,722.1719" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="116.5" y="696.5396">9</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="329" x="129.5" y="688.9731">Add transfer to the processedTransfer list recording</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="133.5" y="704.106">the transfer state values</text>
    <polygon fill="#A80036" points="601.5,747.3047,611.5,751.3047,601.5,755.3047,605.5,751.3047" style="stroke:#A80036;stroke-width:1.0;"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="607.5" y1="751.3047" y2="751.3047"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="116.5" y="746.2388">10</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="320" x="138.5" y="746.2388">Bulk Persist transfer state for all transfers in batch</text>
    <polygon fill="#FFFFE0" filter="url(#f1hx991qlnyej3)" points="331,764.3047,895,764.3047,905,798.3047,895,832.3047,331,832.3047,321,798.3047,331,764.3047" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="333" y="780.3716">batch INSERT</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="422" y="780.3716">transferStateChange</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="580" y="780.3716">transferStateId = &apos;COMMITTED&apos;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="337" y="795.5044"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="560" x="333" y="810.6372">select from transferStateChange table where transferId in ([transferBatch.transferId,...])</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="338" x="333" y="825.77">build list of transferStateChanges from transferBatch</text>
    <polygon fill="#A80036" points="596.5,854.9688,606.5,858.9688,596.5,862.9688,600.5,858.9688" style="stroke:#A80036;stroke-width:1.0;"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="602.5" y1="858.9688" y2="858.9688"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="116.5" y="853.9028">11</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="406" x="138.5" y="853.9028">Bulk Persist participant position change for all transfers in batch</text>
    <polygon fill="#FFFFE0" filter="url(#f1hx991qlnyej3)" points="386,901.9688,841,901.9688,851,950.9688,841,999.9688,386,999.9688,376,950.9688,386,901.9688" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="388" y="918.0356">INSERT</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="196" x="437" y="918.0356">participantPositionChange</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="431" x="388" y="933.1685">SET participantPositionId = participantPosition.participantPositionId,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="451" x="388" y="948.3013">transferStateChangeId = transferStateChange.transferStateChangeId,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="388" y="963.4341">value = latestPosition (???),</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="325" x="388" y="978.5669">reservedValue = participantPosition.reservedValue</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="388" y="993.6997">createdDate = new Date()</text>
    <path d="M114,1017.7656 L114,1390.7656 L384,1390.7656 L384,1027.7656 L374,1017.7656 L114,1017.7656 " fill="#FFFF00" filter="url(#f1hx991qlnyej3)" style="stroke:#A80036;stroke-width:1.0;"/>
    <path d="M374,1017.7656 L374,1027.7656 L384,1027.7656 L374,1017.7656 " fill="#FFFF00" style="stroke:#A80036;stroke-width:1.0;"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="120" y="1034.8325">Message:</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="120" y="1049.9653">{</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="136" y="1065.0981">id: &lt;transferMessage.transferId&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="136" y="1080.231">from: &lt;transferMessage.payerFsp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="136" y="1095.3638">to: &lt;transferMessage.payeeFsp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="136" y="1110.4966">type: application/json</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="136" y="1125.6294">content: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="152" y="1140.7622">headers: &lt;transferHeaders&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="152" y="1155.895">payload: &lt;transferMessage&gt;</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="136" y="1171.0278">},</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="136" y="1186.1606">metadata: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="152" y="1201.2935">event: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="168" y="1216.4263">id: &lt;uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="168" y="1231.5591">responseTo: &lt;previous.uuid&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="168" y="1246.6919">type: transfer,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="168" y="1261.8247">action: commit || reserve,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="168" y="1276.9575">createdAt: &lt;timestamp&gt;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="168" y="1292.0903">state: {</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="184" y="1307.2231">status: &quot;success&quot;,</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="184" y="1322.356">code: 0</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="168" y="1337.4888">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="152" y="1352.6216">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="136" y="1367.7544">}</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="120" y="1382.8872">}</text>
    <polygon fill="#A80036" points="729,1432.2188,739,1436.2188,729,1440.2188,733,1436.2188" style="stroke:#A80036;stroke-width:1.0;"/>
    <line style="stroke:#A80036;stroke-width:1.0;" x1="109.5" x2="735" y1="1436.2188" y2="1436.2188"/>
    <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="116.5" y="1423.5864">12</text>
    <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="138.5" y="1416.02">Publish Transfer event</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="138.5" y="1431.1528">Error code:</text>
    <text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="224.5" y="1431.1528">2003</text>
  </g>
</svg>
